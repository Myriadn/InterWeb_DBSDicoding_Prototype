/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";const t="https://story-api.dicoding.dev/v1";function e(t){return e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},e(t)}function n(){n=function(){return r};var t,r={},o=Object.prototype,i=o.hasOwnProperty,a=Object.defineProperty||function(t,e,n){t[e]=n.value},c="function"==typeof Symbol?Symbol:{},s=c.iterator||"@@iterator",u=c.asyncIterator||"@@asyncIterator",l=c.toStringTag||"@@toStringTag";function f(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,n){return t[e]=n}}function p(t,e,n,r){var o=e&&e.prototype instanceof b?e:b,i=Object.create(o.prototype),c=new I(r||[]);return a(i,"_invoke",{value:j(t,n,c)}),i}function h(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}r.wrap=p;var d="suspendedStart",y="suspendedYield",v="executing",m="completed",g={};function b(){}function w(){}function x(){}var k={};f(k,s,(function(){return this}));var L=Object.getPrototypeOf,E=L&&L(L(A([])));E&&E!==o&&i.call(E,s)&&(k=E);var S=x.prototype=b.prototype=Object.create(k);function _(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,n){function r(o,a,c,s){var u=h(t[o],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==e(f)&&i.call(f,"__await")?n.resolve(f.__await).then((function(t){r("next",t,c,s)}),(function(t){r("throw",t,c,s)})):n.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return r("throw",t,c,s)}))}s(u.arg)}var o;a(this,"_invoke",{value:function(t,e){function i(){return new n((function(n,o){r(t,e,n,o)}))}return o=o?o.then(i,i):i()}})}function j(e,n,r){var o=d;return function(i,a){if(o===v)throw Error("Generator is already running");if(o===m){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=T(c,r);if(s){if(s===g)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===d)throw o=m,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=v;var u=h(e,n,r);if("normal"===u.type){if(o=r.done?m:y,u.arg===g)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=m,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),g;var i=h(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,g;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,g):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,g)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function A(n){if(n||""===n){var r=n[s];if(r)return r.call(n);if("function"==typeof n.next)return n;if(!isNaN(n.length)){var o=-1,a=function e(){for(;++o<n.length;)if(i.call(n,o))return e.value=n[o],e.done=!1,e;return e.value=t,e.done=!0,e};return a.next=a}}throw new TypeError(e(n)+" is not iterable")}return w.prototype=x,a(S,"constructor",{value:x,configurable:!0}),a(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),r.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},r.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(S),t},r.awrap=function(t){return{__await:t}},_(O.prototype),f(O.prototype,u,(function(){return this})),r.AsyncIterator=O,r.async=function(t,e,n,o,i){void 0===i&&(i=Promise);var a=new O(p(t,e,n,o),i);return r.isGeneratorFunction(e)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(S),f(S,l,"Generator"),f(S,s,(function(){return this})),f(S,"toString",(function(){return"[object Generator]"})),r.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},r.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&i.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function r(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var o=this.tryEntries.length-1;o>=0;--o){var a=this.tryEntries[o],c=a.completion;if("root"===a.tryLoc)return r("end");if(a.tryLoc<=this.prev){var s=i.call(a,"catchLoc"),u=i.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return r(a.catchLoc,!0);if(this.prev<a.finallyLoc)return r(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return r(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return r(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&i.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var o=r;break}}o&&("break"===t||"continue"===t)&&o.tryLoc<=e&&e<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=t,a.arg=e,o?(this.method="next",this.next=o.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;N(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),g}},r}function r(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function o(t){return function(){var e=this,n=arguments;return new Promise((function(o,i){var a=t.apply(e,n);function c(t){r(a,o,i,c,s,"next",t)}function s(t){r(a,o,i,c,s,"throw",t)}c(void 0)}))}}var i={REGISTER:"".concat(t,"/register"),LOGIN:"".concat(t,"/login"),STORIES:"".concat(t,"/stories"),STORY_DETAIL:function(e){return"".concat(t,"/stories/").concat(e)},NOTIFICATION_SUBSCRIBE:"".concat(t,"/notifications/subscribe")};function a(t){return c.apply(this,arguments)}function c(){return(c=o(n().mark((function t(e){var r,o,a,c;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.name,o=e.email,a=e.password,t.next=3,fetch(i.REGISTER,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:r,email:o,password:a})});case 3:return c=t.sent,t.next=6,c.json();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function s(t){return u.apply(this,arguments)}function u(){return(u=o(n().mark((function t(e){var r,o,a;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.email,o=e.password,t.next=3,fetch(i.LOGIN,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:r,password:o})});case 3:return a=t.sent,t.next=6,a.json();case 6:return t.abrupt("return",t.sent);case 7:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function l(t){return f.apply(this,arguments)}function f(){return(f=o(n().mark((function t(e){var r,o,a,c,s,u,l;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=e.description,o=e.photo,a=e.lat,c=e.lon,s=e.token,(u=new FormData).append("description",r),u.append("photo",o),a&&c&&(u.append("lat",a),u.append("lon",c)),t.next=7,fetch(i.STORIES,{method:"POST",headers:{Authorization:"Bearer ".concat(s)},body:u});case 7:return l=t.sent,t.next=10,l.json();case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function p(){return h.apply(this,arguments)}function h(){return h=o(n().mark((function t(){var e,r,o,a,c,s=arguments;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=s.length>0&&void 0!==s[0]?s[0]:1,r=s.length>1&&void 0!==s[1]?s[1]:10,o=s.length>2&&void 0!==s[2]?s[2]:0,a=localStorage.getItem("token")){t.next=6;break}return t.abrupt("return",{error:!0,message:"Token tidak tersedia"});case 6:return t.prev=6,t.next=9,fetch("".concat(i.STORIES,"?page=").concat(e,"&size=").concat(r,"&location=").concat(o),{headers:{Authorization:"Bearer ".concat(a)}});case 9:if((c=t.sent).ok){t.next=12;break}return t.abrupt("return",{error:!0,message:"Error ".concat(c.status,": ").concat(c.statusText)});case 12:return t.next=14,c.json();case 14:return t.abrupt("return",t.sent);case 17:return t.prev=17,t.t0=t.catch(6),console.error("Error getting stories:",t.t0),t.abrupt("return",{error:!0,message:"Gagal memuat cerita"});case 21:case"end":return t.stop()}}),t,null,[[6,17]])}))),h.apply(this,arguments)}function d(t){return y.apply(this,arguments)}function y(){return(y=o(n().mark((function t(e){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("token")){t.next=3;break}return t.abrupt("return",{error:!0,message:"Token tidak tersedia"});case 3:return t.prev=3,t.next=6,fetch(i.STORY_DETAIL(e),{headers:{Authorization:"Bearer ".concat(r)}});case 6:if((o=t.sent).ok){t.next=9;break}return t.abrupt("return",{error:!0,message:"Error ".concat(o.status,": ").concat(o.statusText)});case 9:return t.next=11,o.json();case 11:return t.abrupt("return",t.sent);case 14:return t.prev=14,t.t0=t.catch(3),console.error("Error getting story detail:",t.t0),t.abrupt("return",{error:!0,message:"Gagal memuat detail cerita"});case 18:case"end":return t.stop()}}),t,null,[[3,14]])})))).apply(this,arguments)}function v(t){return m.apply(this,arguments)}function m(){return(m=o(n().mark((function t(e){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("token")){t.next=3;break}return t.abrupt("return",{error:!0,message:"Token tidak tersedia"});case 3:return t.prev=3,t.next=6,fetch(i.NOTIFICATION_SUBSCRIBE,{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(e)});case 6:if((o=t.sent).ok){t.next=9;break}return t.abrupt("return",{error:!0,message:"Error ".concat(o.status,": ").concat(o.statusText)});case 9:return t.next=11,o.json();case 11:return t.abrupt("return",t.sent);case 14:return t.prev=14,t.t0=t.catch(3),console.error("Error subscribing to notification:",t.t0),t.abrupt("return",{error:!0,message:"Gagal berlangganan notifikasi"});case 18:case"end":return t.stop()}}),t,null,[[3,14]])})))).apply(this,arguments)}function g(t){return b.apply(this,arguments)}function b(){return(b=o(n().mark((function t(e){var r,o;return n().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=localStorage.getItem("token")){t.next=3;break}return t.abrupt("return",{error:!0,message:"Token tidak tersedia"});case 3:return t.prev=3,t.next=6,fetch(i.NOTIFICATION_SUBSCRIBE,{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(e)});case 6:if((o=t.sent).ok){t.next=9;break}return t.abrupt("return",{error:!0,message:"Error ".concat(o.status,": ").concat(o.statusText)});case 9:return t.next=11,o.json();case 11:return t.abrupt("return",t.sent);case 14:return t.prev=14,t.t0=t.catch(3),console.error("Error unsubscribing from notification:",t.t0),t.abrupt("return",{error:!0,message:"Gagal berhenti berlangganan notifikasi"});case 18:case"end":return t.stop()}}),t,null,[[3,14]])})))).apply(this,arguments)}function w(t){return w="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},w(t)}function x(){x=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(r||[]);return o(a,"_invoke",{value:j(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var k={};u(k,a,(function(){return this}));var L=Object.getPrototypeOf,E=L&&L(L(A([])));E&&E!==n&&r.call(E,a)&&(k=E);var S=b.prototype=m.prototype=Object.create(k);function _(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==w(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=T(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(w(e)+" is not iterable")}return g.prototype=b,o(S,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(S),t},e.awrap=function(t){return{__await:t}},_(O.prototype),u(O.prototype,c,(function(){return this})),e.AsyncIterator=O,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new O(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},_(S),u(S,s,"Generator"),u(S,a,(function(){return this})),u(S,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;N(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function k(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function E(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){k(i,r,o,a,c,"next",t)}function c(t){k(i,r,o,a,c,"throw",t)}a(void 0)}))}}const S={isNotificationSupported:function(){return"Notification"in window},isPushNotificationSupported:function(){return"serviceWorker"in navigator&&"PushManager"in window},requestPermission:function(){var t=this;return E(x().mark((function e(){var n;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isNotificationSupported()){e.next=3;break}return console.log("Browser tidak mendukung notifikasi"),e.abrupt("return",!1);case 3:return e.next=5,Notification.requestPermission();case 5:if("denied"!==(n=e.sent)){e.next=9;break}return console.log("Izin notifikasi ditolak"),e.abrupt("return",!1);case 9:if("default"!==n){e.next=12;break}return console.log("Izin notifikasi diabaikan"),e.abrupt("return",!1);case 12:return e.abrupt("return",!0);case 13:case"end":return e.stop()}}),e)})))()},registerServiceWorker:function(){return E(x().mark((function t(){var e;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"serviceWorker"in navigator){t.next=4;break}return console.log("Service worker tidak didukung browser ini"),t.abrupt("return",null);case 4:return t.next=6,navigator.serviceWorker.register("/sw.js");case 6:return e=t.sent,console.log("Service worker berhasil didaftarkan",e),t.abrupt("return",e);case 11:return t.prev=11,t.t0=t.catch(0),console.error("Pendaftaran service worker gagal",t.t0),t.abrupt("return",null);case 15:case"end":return t.stop()}}),t,null,[[0,11]])})))()},subscribePushNotification:function(t){var e=this;return E(x().mark((function n(){var r,o,i,a,c,s;return x().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.requestPermission();case 3:if(n.sent){n.next=6;break}return n.abrupt("return",{status:!1,message:"Izin notifikasi tidak diberikan"});case 6:return n.next=8,e.checkSubscription();case 8:if(!(r=n.sent)){n.next=11;break}return n.abrupt("return",{status:!0,message:"Anda sudah berlangganan notifikasi",subscription:r});case 11:return o=e._urlBase64ToUint8Array("BCCs2eonMI-6H2ctvFaWg-UYdDv387Vno_bzUzALpB442r2lCnsHmtrx8biyPi_E-1fSGABK_Qs_GlvPoJJqxbk"),n.next=15,t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o});case 15:if(i=n.sent,console.log("Berhasil membuat subscription: ",i),localStorage.getItem("token")){n.next=20;break}return n.abrupt("return",{status:!1,message:"Token tidak ditemukan, silakan login ulang"});case 20:return a=i.toJSON(),c={endpoint:a.endpoint,keys:{p256dh:a.keys.p256dh,auth:a.keys.auth}},n.next=24,v(c);case 24:if(!(s=n.sent).error){n.next=27;break}return n.abrupt("return",{status:!1,message:s.message||"Gagal berlangganan notifikasi di server"});case 27:return localStorage.setItem("pushSubscription",JSON.stringify(a)),localStorage.setItem("isSubscribed","true"),n.abrupt("return",{status:!0,message:"Berlangganan notifikasi berhasil",subscription:i});case 32:return n.prev=32,n.t0=n.catch(0),console.error("Gagal berlangganan push notification",n.t0),n.abrupt("return",{status:!1,message:"Gagal berlangganan notifikasi: "+n.t0.message});case 36:case"end":return n.stop()}}),n,null,[[0,32]])})))()},unsubscribePushNotification:function(){return E(x().mark((function t(){var e,n,r,o;return x().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.ready;case 3:return e=t.sent,t.next=6,e.pushManager.getSubscription();case 6:if(n=t.sent){t.next=9;break}return t.abrupt("return",{status:!1,message:"Anda belum berlangganan notifikasi"});case 9:if(r=n.endpoint,localStorage.getItem("token")){t.next=13;break}return t.abrupt("return",{status:!1,message:"Token tidak ditemukan, silakan login ulang"});case 13:return t.next=15,g({endpoint:r});case 15:return o=t.sent,t.next=18,n.unsubscribe();case 18:return localStorage.removeItem("pushSubscription"),localStorage.setItem("isSubscribed","false"),t.abrupt("return",{status:!0,message:o.message||"Berhenti berlangganan notifikasi berhasil"});case 23:return t.prev=23,t.t0=t.catch(0),console.error("Gagal berhenti berlangganan push notification",t.t0),t.abrupt("return",{status:!1,message:"Gagal berhenti berlangganan notifikasi: "+t.t0.message});case 27:case"end":return t.stop()}}),t,null,[[0,23]])})))()},checkSubscription:function(){var t=this;return E(x().mark((function e(){var n,r;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.isPushNotificationSupported()){e.next=2;break}return e.abrupt("return",null);case 2:return e.prev=2,e.next=5,navigator.serviceWorker.ready;case 5:return n=e.sent,e.next=8,n.pushManager.getSubscription();case 8:return r=e.sent,e.abrupt("return",r);case 12:return e.prev=12,e.t0=e.catch(2),console.error("Gagal memeriksa status subscription",e.t0),e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,null,[[2,12]])})))()},isUserSubscribed:function(){return"true"===localStorage.getItem("isSubscribed")},getNotificationPermissionStatus:function(){return this.isNotificationSupported()?Notification.permission:"not-supported"},syncSubscriptionStatus:function(){var t=this;return E(x().mark((function e(){var n,r,o;return x().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.checkSubscription();case 3:if(n=e.sent,r=t.getNotificationPermissionStatus(),o="true"===localStorage.getItem("isSubscribed"),n||!o){e.next=10;break}return localStorage.setItem("isSubscribed","false"),localStorage.removeItem("pushSubscription"),e.abrupt("return",!1);case 10:if("denied"!==r||!o){e.next=14;break}return localStorage.setItem("isSubscribed","false"),localStorage.removeItem("pushSubscription"),e.abrupt("return",!1);case 14:if(!n||o){e.next=18;break}return localStorage.setItem("isSubscribed","true"),localStorage.setItem("pushSubscription",JSON.stringify(n.toJSON())),e.abrupt("return",!0);case 18:return e.abrupt("return",o);case 21:return e.prev=21,e.t0=e.catch(0),console.error("Gagal menyinkronkan status subscription:",e.t0),e.abrupt("return",!1);case 25:case"end":return e.stop()}}),e,null,[[0,21]])})))()},_urlBase64ToUint8Array:function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/-/g,"+").replace(/_/g,"/"),n=window.atob(e),r=new Uint8Array(n.length),o=0;o<n.length;o++)r[o]=n.charCodeAt(o);return r}};function _(t){return _="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_(t)}function O(){O=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(r||[]);return o(a,"_invoke",{value:j(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==_(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=T(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function T(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,T(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function N(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(_(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(N),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),N(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;N(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function j(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}const T={_previousStoryIds:[],checkForNewStories:function(t){var e,n=this;return(e=O().mark((function e(){var r;return O().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&Array.isArray(t)&&0!==t.length){e.next=2;break}return e.abrupt("return");case 2:if(0!==n._previousStoryIds.length){e.next=5;break}return n._previousStoryIds=t.map((function(t){return t.id})),e.abrupt("return");case 5:r=t.filter((function(t){return!n._previousStoryIds.includes(t.id)})),n._previousStoryIds=t.map((function(t){return t.id})),r.length>0&&S.isUserSubscribed()&&r.forEach((function(t){n._sendNotification(t)}));case 8:case"end":return e.stop()}}),e)})),function(){var t=this,n=arguments;return new Promise((function(r,o){var i=e.apply(t,n);function a(t){j(i,r,o,a,c,"next",t)}function c(t){j(i,r,o,a,c,"throw",t)}a(void 0)}))})()},_sendNotification:function(t){if(S.isNotificationSupported())try{if("granted"!==Notification.permission)return;var e={body:t.description.substring(0,100)+"...",icon:"/favicon.png",badge:"/favicon.png",vibrate:[100,50,100],data:{dateOfArrival:Date.now(),storyId:t.id,url:"/#/story/".concat(t.id)},actions:[{action:"open",title:"Lihat Story"},{action:"close",title:"Tutup"}]};"serviceWorker"in navigator&&"PushManager"in window?navigator.serviceWorker.ready.then((function(n){n.showNotification("Story baru dari ".concat(t.name),e)})):new Notification("Story baru dari ".concat(t.name),e)}catch(t){console.error("Error menampilkan notifikasi:",t)}}};function P(t){return P="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},P(t)}function N(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function I(){I=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new N(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==P(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function A(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(P(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=A,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:A(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function A(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function G(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){A(i,r,o,a,c,"next",t)}function c(t){A(i,r,o,a,c,"throw",t)}a(void 0)}))}}function C(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,F(r.key),r)}}function F(t){var e=function(t){if("object"!=P(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=P(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==P(e)?e:e+""}var B=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e,this.stories=[],this._setupPeriodicCheck()},e=[{key:"loadStories",value:(n=G(I().mark((function t(){var e,n;return I().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,localStorage.getItem("token")){t.next=5;break}return window.location.hash="/login",t.abrupt("return");case 5:return(e=document.getElementById("story-list"))&&(e.innerHTML='<div class="loading">Loading stories...</div>'),t.next=9,p();case 9:if(!(n=t.sent).error){t.next=13;break}return this.view.showError(n.message||"Failed to load stories"),t.abrupt("return");case 13:return this.stories=n.listStory||[],t.next=16,T.checkForNewStories(this.stories);case 16:this.stories.length>0?this.view.displayStories(this.stories):this.view.showEmptyState(),t.next=23;break;case 19:t.prev=19,t.t0=t.catch(0),console.error("Error loading stories:",t.t0),this.view.showError("Failed to load stories. Please try again later.");case 23:case"end":return t.stop()}}),t,this,[[0,19]])}))),function(){return n.apply(this,arguments)})},{key:"_setupPeriodicCheck",value:function(){var t=this;this._checkInterval=setInterval(G(I().mark((function e(){return I().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if("#/"!==window.location.hash&&""!==window.location.hash){e.next=3;break}return e.next=3,t.loadStories();case 3:case"end":return e.stop()}}),e)}))),6e4)}},{key:"cleanupInterval",value:function(){this._checkInterval&&clearInterval(this._checkInterval)}},{key:"sortStoriesByDate",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=function(t){return function(t){if(Array.isArray(t))return N(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return N(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?N(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(this.stories).sort((function(e,n){var r=new Date(e.createdAt),o=new Date(n.createdAt);return t?r-o:o-r}));this.view.displayStories(e)}}],e&&C(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}();function M(t){return M="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},M(t)}function z(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,q(r.key),r)}}function D(t,e,n){return(e=q(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function q(t){var e=function(t){if("object"!=M(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=M(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==M(e)?e:e+""}var Y=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"setupAuthenticatedNavigation",value:function(){var t=localStorage.getItem("token"),e=document.querySelector("#nav-list"),n=document.querySelector("#navigation-drawer"),r=document.querySelector("#drawer-button");if(t){if(n&&(n.style.display="block",r&&(window.innerWidth<=1e3?(r.style.display="inline-block",this._setupDrawerToggle(r,n)):r.style.display="none")),e){e.innerHTML="",e.innerHTML='\n      <li>\n        <a href="#/" aria-label="Beranda" title="Beranda"><i class="fas fa-home"></i></a>\n      </li>\n      <li>\n        <a href="#/add-story" aria-label="Tambah Story" title="Tambah Story"><i class="fas fa-plus"></i></a>\n      </li>\n      <li>\n        <a href="#/saved-stories" aria-label="Story Tersimpan" title="Story Tersimpan"><i class="fas fa-bookmark"></i></a>\n      </li>\n      <li>\n        <a href="#/about" aria-label="Tentang Aplikasi" title="Tentang Aplikasi"><i class="fas fa-globe"></i></a>\n      </li>\n      <li>\n        <a href="#" id="logout-button" aria-label="Logout" title="Logout"><i class="fas fa-sign-out-alt"></i></a>\n      </li>\n    ';var o=document.querySelector("#logout-button");o&&o.addEventListener("click",(function(t){t.preventDefault(),localStorage.removeItem("token"),localStorage.removeItem("userName"),window.location.hash="/login"})),this._setupMenuItemClick(e,n),this._setupResizeHandler(n,r)}}else window.location.hash="/login"}},{key:"setupUnauthenticatedNavigation",value:function(){var t=document.querySelector("#navigation-drawer");t&&(t.style.display="none");var e=document.querySelector("#drawer-button");e&&(e.style.display="none"),this._removeEventListeners()}},{key:"_setupDrawerToggle",value:function(t,e){this._removeEventListeners(),this.drawerToggleHandler=function(){e.classList.toggle("open")},t.addEventListener("click",this.drawerToggleHandler),this.documentClickHandler=function(n){!e.classList.contains("open")||e.contains(n.target)||t.contains(n.target)||e.classList.remove("open")},document.addEventListener("click",this.documentClickHandler)}},{key:"_setupMenuItemClick",value:function(t,e){t&&e&&t.querySelectorAll("a").forEach((function(t){t.addEventListener("click",(function(){window.innerWidth<=1e3&&e.classList.remove("open")}))}))}},{key:"_setupResizeHandler",value:function(t,e){window.addEventListener("resize",(function(){window.innerWidth<=1e3?e&&(e.style.display="inline-block"):(e&&(e.style.display="none"),t&&t.classList.remove("open"))}))}},{key:"_removeEventListeners",value:function(){var t=document.querySelector("#drawer-button");t&&this.drawerToggleHandler&&t.removeEventListener("click",this.drawerToggleHandler),this.documentClickHandler&&document.removeEventListener("click",this.documentClickHandler)}}],null&&z(t.prototype,null),e&&z(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();D(Y,"drawerToggleHandler",null),D(Y,"documentClickHandler",null);const H=Y;function R(t){return R="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},R(t)}function U(){U=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==R(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(R(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function W(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),n.push.apply(n,r)}return n}function J(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?W(Object(n),!0).forEach((function(e){X(t,e,n[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):W(Object(n)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))}))}return t}function Z(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function K(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Z(i,r,o,a,c,"next",t)}function c(t){Z(i,r,o,a,c,"throw",t)}a(void 0)}))}}function V(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,$(r.key),r)}}function X(t,e,n){return(e=$(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $(t){var e=function(t){if("object"!=R(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=R(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==R(e)?e:e+""}var Q=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"openDB",value:function(){var t=this;return new Promise((function(e,n){if(window.indexedDB){var r=window.indexedDB.open(t.DB_NAME,t.DB_VERSION);r.onerror=function(t){n(new Error("Gagal membuka database IndexedDB"))},r.onsuccess=function(t){e(t.target.result)},r.onupgradeneeded=function(e){var n=e.target.result;if(!n.objectStoreNames.contains(t.OBJECT_STORE_NAME)){var r=n.createObjectStore(t.OBJECT_STORE_NAME,{keyPath:"id"});r.createIndex("name","name",{unique:!1}),r.createIndex("createdAt","createdAt",{unique:!1}),r.createIndex("savedAt","savedAt",{unique:!1})}}}else n(new Error("Browser tidak mendukung IndexedDB"))}))}},{key:"saveStory",value:(c=K(U().mark((function t(e){var n,r=this;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.openDB();case 3:return n=t.sent,t.abrupt("return",new Promise((function(t,o){var i=J(J({},e),{},{savedAt:(new Date).toISOString()}),a=n.transaction(r.OBJECT_STORE_NAME,"readwrite"),c=a.objectStore(r.OBJECT_STORE_NAME).put(i);c.onsuccess=function(){t(i)},c.onerror=function(){o(new Error("Gagal menyimpan story"))},a.oncomplete=function(){n.close()}})));case 7:throw t.prev=7,t.t0=t.catch(0),console.error("Error in saveStory:",t.t0),t.t0;case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return c.apply(this,arguments)})},{key:"getAllSavedStories",value:(a=K(U().mark((function t(){var e,n,r,o=this,i=arguments;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=i.length>0&&void 0!==i[0]?i[0]:"savedAt",n=i.length>1&&void 0!==i[1]&&i[1],t.prev=2,t.next=5,this.openDB();case 5:return r=t.sent,t.abrupt("return",new Promise((function(t,i){var a=r.transaction(o.OBJECT_STORE_NAME,"readonly"),c=a.objectStore(o.OBJECT_STORE_NAME),s="id"!==e&&c.indexNames.contains(e)?c.index(e).getAll():c.getAll();s.onsuccess=function(){var r=s.result.sort((function(t,r){var o=t[e],i=r[e];return"string"==typeof o&&(o.includes("T")||o.includes("-"))?n?new Date(o)-new Date(i):new Date(i)-new Date(o):n?o>i?1:-1:o<i?1:-1}));t(r)},s.onerror=function(){i(new Error("Gagal mengambil data story tersimpan"))},a.oncomplete=function(){r.close()}})));case 9:return t.prev=9,t.t0=t.catch(2),console.error("Error in getAllSavedStories:",t.t0),t.abrupt("return",[]);case 13:case"end":return t.stop()}}),t,this,[[2,9]])}))),function(){return a.apply(this,arguments)})},{key:"getSavedStoryById",value:(i=K(U().mark((function t(e){var n,r=this;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.openDB();case 3:return n=t.sent,t.abrupt("return",new Promise((function(t,o){var i=n.transaction(r.OBJECT_STORE_NAME,"readonly"),a=i.objectStore(r.OBJECT_STORE_NAME).get(e);a.onsuccess=function(){t(a.result||null)},a.onerror=function(){o(new Error("Gagal mendapatkan story"))},i.oncomplete=function(){n.close()}})));case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error in getSavedStoryById:",t.t0),t.abrupt("return",null);case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return i.apply(this,arguments)})},{key:"deleteSavedStory",value:(o=K(U().mark((function t(e){var n,r=this;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.openDB();case 3:return n=t.sent,t.abrupt("return",new Promise((function(t,o){var i=n.transaction(r.OBJECT_STORE_NAME,"readwrite"),a=i.objectStore(r.OBJECT_STORE_NAME).delete(e);a.onsuccess=function(){t(!0)},a.onerror=function(){o(new Error("Gagal menghapus story"))},i.oncomplete=function(){n.close()}})));case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error in deleteSavedStory:",t.t0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return o.apply(this,arguments)})},{key:"isStorySaved",value:(r=K(U().mark((function t(e){var n;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.getSavedStoryById(e);case 3:return n=t.sent,t.abrupt("return",!!n);case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error in isStorySaved:",t.t0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(t){return r.apply(this,arguments)})},{key:"clearAllSavedStories",value:(n=K(U().mark((function t(){var e,n=this;return U().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,this.openDB();case 3:return e=t.sent,t.abrupt("return",new Promise((function(t,r){var o=e.transaction(n.OBJECT_STORE_NAME,"readwrite"),i=o.objectStore(n.OBJECT_STORE_NAME).clear();i.onsuccess=function(){t(!0)},i.onerror=function(){r(new Error("Gagal menghapus semua story"))},o.oncomplete=function(){e.close()}})));case 7:return t.prev=7,t.t0=t.catch(0),console.error("Error in clearAllSavedStories:",t.t0),t.abrupt("return",!1);case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return n.apply(this,arguments)})}],e&&V(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o,i,a,c}();X(Q,"DB_NAME","myriadn-story-app"),X(Q,"DB_VERSION",1),X(Q,"OBJECT_STORE_NAME","saved-stories");const tt=Q;function et(t){return et="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},et(t)}function nt(){nt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==et(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(et(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function rt(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function ot(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){rt(i,r,o,a,c,"next",t)}function c(t){rt(i,r,o,a,c,"throw",t)}a(void 0)}))}}function it(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,at(r.key),r)}}function at(t){var e=function(t){if("object"!=et(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=et(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==et(e)?e:e+""}var ct=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new B(this),this._isOnline=navigator.onLine,this._savedStoryIds=new Set},e=[{key:"render",value:(o=ot(nt().mark((function t(){var e,n;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=localStorage.getItem("userName"),n=S.isPushNotificationSupported(),t.abrupt("return",'\n      <section class="container" id="main-content">\n        <div class="welcome-user">\n          <h2><i class="fas fa-user"></i> Selamat datang, '.concat(e||"User","!</h2>\n        </div>\n        ").concat(n?'\n          <div class="notification-container">\n            <button id="btnSubscription" class="btn-subscribe">\n              <i class="fas fa-bell"></i> <span id="subscriptionStatus">Aktifkan Notifikasi Cerita Baru</span>\n            </button>\n          </div>\n        ':"",'\n        <h1>Daftar Story</h1>\n        \n        \x3c!-- App Shell untuk menampilkan konten saat loading atau offline --\x3e\n        <div id="story-list" class="content-loading">\n          <div class="app-shell-skeleton"></div>\n        </div>\n      </section>\n    '));case 3:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(r=ot(nt().mark((function t(){return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return H.setupAuthenticatedNavigation(),this._setupSubscriptionButton(),this._setupOnlineOfflineHandler(),t.next=5,this._loadSavedStoryIds();case 5:this.presenter.loadStories();case 6:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"_setupSubscriptionButton",value:function(){var t=this,e=document.getElementById("btnSubscription");e&&(S.syncSubscriptionStatus().then(ot(nt().mark((function e(){return nt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t._updateSubscriptionButtonUI(),"denied"===S.getNotificationPermissionStatus()&&t._showNotification("Izin notifikasi ditolak oleh browser. Ubah pengaturan browser Anda untuk mengizinkan notifikasi");case 3:case"end":return e.stop()}}),e)})))),e.addEventListener("click",ot(nt().mark((function n(){var r,o,i;return nt().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(n.prev=0,e.disabled=!0,!S.isUserSubscribed()){n.next=10;break}return n.next=6,S.unsubscribePushNotification();case 6:r=n.sent,t._showNotification(r.message),n.next=22;break;case 10:return n.next=12,S.registerServiceWorker();case 12:if(o=n.sent){n.next=17;break}return t._showNotification("Gagal mendaftarkan service worker"),e.disabled=!1,n.abrupt("return");case 17:return n.next=19,S.subscribePushNotification(o);case 19:i=n.sent,t._showNotification(i.message),"default"===S.getNotificationPermissionStatus()&&t._showNotification("Anda mengabaikan permintaan izin notifikasi. Klik tombol lagi untuk mencoba.");case 22:n.next=28;break;case 24:n.prev=24,n.t0=n.catch(0),console.error("Error in subscription toggle:",n.t0),t._showNotification("Terjadi kesalahan: "+n.t0.message);case 28:return n.prev=28,n.next=31,S.syncSubscriptionStatus();case 31:return t._updateSubscriptionButtonUI(),e.disabled=!1,n.finish(28);case 34:case"end":return n.stop()}}),n,null,[[0,24,28,34]])})))))}},{key:"_setupOnlineOfflineHandler",value:function(){var t=this;window.addEventListener("online",(function(){t._isOnline=!0,t._showNotification("Anda kembali online. Menyegarkan data..."),t.presenter.loadStories()})),window.addEventListener("offline",(function(){t._isOnline=!1,t._showNotification("Anda sedang offline. Data yang ditampilkan mungkin tidak terbaru.")}))}},{key:"_updateSubscriptionButtonUI",value:function(){var t=document.getElementById("btnSubscription"),e=document.getElementById("subscriptionStatus");if(t&&e){var n=S.isUserSubscribed(),r=S.getNotificationPermissionStatus();return t.classList.remove("subscribed","btn-subscribe","btn-unsubscribe","disabled"),"not-supported"===r?(t.classList.add("disabled"),t.disabled=!0,void(e.textContent="Notifikasi tidak didukung di browser ini")):"denied"===r?(t.classList.add("disabled"),t.disabled=!0,void(e.textContent="Notifikasi ditolak (Ubah pengaturan browser)")):void(n?(t.classList.add("subscribed"),t.classList.add("btn-unsubscribe"),e.textContent="Notifikasi Aktif (Klik untuk nonaktifkan)"):(t.classList.add("btn-subscribe"),e.textContent="Aktifkan Notifikasi Cerita Baru"))}}},{key:"_showNotification",value:function(t){try{var e=document.querySelector(".toast-notification");e||((e=document.createElement("div")).className="toast-notification hidden",document.body.appendChild(e)),setTimeout((function(){e&&(e.textContent=t,e.classList.remove("hidden"),setTimeout((function(){e&&e.classList.add("hidden")}),3e3))}),0)}catch(t){console.error("Error showing notification:",t)}}},{key:"displayStories",value:function(t){var e=this,n=document.getElementById("story-list");if(n)if(n.classList.remove("content-loading"),t&&0!==t.length){n.innerHTML=t.map((function(t){var n=e._savedStoryIds.has(t.id),r=n?"Hapus dari Tersimpan":"Simpan Story",o=n?"fa-trash":"fa-bookmark",i=n?"unsave-button":"save-button";return'\n            <div class="story-item">\n              '.concat(n?'\n                <div class="saved-indicator">\n                  <i class="fas fa-bookmark"></i>\n                </div>\n              ':"",'\n              <img src="').concat(t.photoUrl,'" \n                  alt="Foto oleh ').concat(t.name,": ").concat(t.description,'"\n                  loading="lazy"\n                  onerror="this.onerror=null; this.src=\'/images/icons/icon-192x192.png\'; this.alt=\'Gambar tidak tersedia saat offline\';">\n              <h2>').concat(t.name,"</h2>\n              <p>").concat(t.description,'</p>\n              <p class="created-at"><i class="fas fa-calendar"></i> ').concat(e.formatDate(t.createdAt),"</p>\n              ").concat(t.lat&&t.lon?e._isOnline?'<div class="mini-map" \n                        data-lat="'.concat(t.lat,'" \n                        data-lon="').concat(t.lon,'"></div>'):'<div class="offline-map-placeholder">\n                        <i class="fas fa-map-marker-alt"></i> Lokasi: '.concat(t.lat.toFixed(4),", ").concat(t.lon.toFixed(4),"\n                        <p>Peta tidak tersedia saat offline</p>\n                      </div>"):"",'\n              <div class="story-action">\n                <a href="#/story/').concat(t.id,'" class="detail-button">Lihat Detail</a>\n                <button class="').concat(i,'" data-id="').concat(t.id,'" data-saved="').concat(n,'">\n                  <i class="fas ').concat(o,'"></i> ').concat(r,"\n                </button>\n              </div>\n            </div>\n          ")})).join("");var r=document.createElement("style");r.textContent="\n      .story-item {\n        display: flex;\n        flex-direction: column;\n        margin-bottom: 30px;\n        padding: 20px;\n        border-radius: 8px;\n        box-shadow: 0 2px 8px rgba(0,0,0,0.1);\n        position: relative;\n      }\n      \n      .story-item img {\n        width: 100%;\n        border-radius: 6px;\n        margin-bottom: 15px;\n        max-height: 300px;\n        object-fit: cover;\n      }\n      \n      .story-item h2 {\n        margin-bottom: 10px;\n      }\n      \n      .story-item p {\n        margin-bottom: 12px;\n      }\n      \n      .created-at {\n        color: #777;\n        font-size: 0.9em;\n        margin-bottom: 15px;\n      }\n      \n      .mini-map {\n        margin-bottom: 20px;\n      }\n      \n      .story-action {\n        margin-top: 16px;\n        display: flex;\n        justify-content: space-between;\n        gap: 10px;\n      }\n      \n      .detail-button {\n        display: inline-block;\n        background-color: #3498db;\n        color: white;\n        padding: 8px 16px;\n        border-radius: 4px;\n        text-decoration: none;\n        font-weight: 500;\n        transition: background-color 0.3s, transform 0.2s;\n      }\n      \n      .detail-button:hover {\n        background-color: #2980b9;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n      }\n\n      .save-button, .unsave-button {\n        padding: 8px 16px;\n        border-radius: 4px;\n        cursor: pointer;\n        font-weight: 500;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        transition: all 0.3s ease;\n        border: none;\n      }\n      \n      .save-button {\n        background-color: #27ae60;\n        color: white;\n      }\n      \n      .save-button:hover {\n        background-color: #219853;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n      }\n      \n      .unsave-button {\n        background-color: #e74c3c;\n        color: white;\n      }\n      \n      .unsave-button:hover {\n        background-color: #c0392b;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n      }\n      \n      .saved-indicator {\n        position: absolute;\n        top: 12px;\n        right: 12px;\n        background-color: rgba(52, 152, 219, 0.9);\n        color: white;\n        padding: 5px 10px;\n        border-radius: 20px;\n        font-size: 0.8rem;\n        display: flex;\n        align-items: center;\n        gap: 5px;\n      }\n\n      .notification-container {\n        margin: 20px 0;\n        display: flex;\n        justify-content: center;\n      }\n\n      .btn-subscribe, .btn-unsubscribe {\n        padding: 10px 20px;\n        border-radius: 50px;\n        border: none;\n        cursor: pointer;\n        font-size: 16px;\n        display: flex;\n        align-items: center;\n        gap: 10px;\n        transition: all 0.3s ease;\n      }\n\n      .btn-subscribe {\n        background-color: #3498db;\n        color: white;\n        box-shadow: 0 3px 6px rgba(0, 0, 0, 0.1);\n      }\n\n      .btn-subscribe:hover {\n        background-color: #2980b9;\n        transform: translateY(-2px);\n        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);\n      }\n\n      .btn-unsubscribe {\n        background-color: #e74c3c;\n        color: white;\n      }\n\n      .btn-unsubscribe:hover {\n        background-color: #c0392b;\n        transform: translateY(-2px);\n        box-shadow: 0 5px 10px rgba(0, 0, 0, 0.15);\n      }\n\n      .toast-notification {\n        position: fixed;\n        bottom: 20px;\n        left: 50%;\n        transform: translateX(-50%);\n        background-color: #2ecc71;\n        color: white;\n        padding: 15px 25px;\n        border-radius: 8px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n        z-index: 1000;\n        opacity: 1;\n        transition: opacity 0.3s ease, transform 0.3s ease;\n      }\n\n      .toast-notification.hidden {\n        opacity: 0;\n        transform: translate(-50%, 20px);\n      }\n      \n      .offline-map-placeholder {\n        background-color: #f8f9fa;\n        border: 1px dashed #ccc;\n        padding: 15px;\n        border-radius: 6px;\n        text-align: center;\n        margin-bottom: 20px;\n      }\n      \n      .offline-map-placeholder i {\n        color: #3498db;\n        margin-right: 5px;\n      }\n      \n      .offline-map-placeholder p {\n        margin-top: 10px;\n        font-size: 0.9em;\n        color: #666;\n      }\n    ",document.head.appendChild(r),this._setupSaveButtons(),this._isOnline&&this.initMiniMaps()}else this.showEmptyState()}},{key:"_setupSaveButtons",value:function(){var t=this;try{setTimeout((function(){document.querySelectorAll(".save-button, .unsave-button").forEach((function(e){e.addEventListener("click",function(){var e=ot(nt().mark((function e(n){var r,o,i,a,c,s,u,l,f,p,h,d,y,v,m,g;return nt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,r=n.currentTarget.dataset.id,o="true"===n.currentTarget.dataset.saved,i=n.currentTarget.closest(".story-item")){e.next=6;break}return e.abrupt("return");case 6:if(a="",c="",s="",(u=i.querySelector("h2"))&&(a=u.textContent),(l=i.querySelector("p:not(.created-at)"))&&(c=l.textContent),(f=i.querySelector("img"))&&(s=f.src),(p=i.querySelector(".created-at"))&&p.textContent,h=i.querySelector(".mini-map"),d=null,y=null,h&&(h.dataset.lat&&(d=parseFloat(h.dataset.lat)),h.dataset.lon&&(y=parseFloat(h.dataset.lon))),!o){e.next=32;break}return e.next=25,tt.deleteSavedStory(r);case 25:t._showNotification("Story berhasil dihapus dari tersimpan"),n.currentTarget&&(n.currentTarget.innerHTML='<i class="fas fa-bookmark"></i> Simpan Story',n.currentTarget.classList.remove("unsave-button"),n.currentTarget.classList.add("save-button"),n.currentTarget.dataset.saved="false"),(v=i.querySelector(".saved-indicator"))&&v.remove(),t._savedStoryIds.delete(r),e.next=39;break;case 32:return m={id:r,name:a,description:c,photoUrl:s,createdAt:(new Date).toISOString(),lat:d,lon:y},e.next=35,tt.saveStory(m);case 35:t._showNotification("Story berhasil disimpan"),n.currentTarget&&(n.currentTarget.innerHTML='<i class="fas fa-trash"></i> Hapus dari Tersimpan',n.currentTarget.classList.remove("save-button"),n.currentTarget.classList.add("unsave-button"),n.currentTarget.dataset.saved="true"),i.querySelector(".saved-indicator")||((g=document.createElement("div")).className="saved-indicator",g.innerHTML='<i class="fas fa-bookmark"></i>',i.prepend(g)),t._savedStoryIds.add(r);case 39:e.next=45;break;case 41:e.prev=41,e.t0=e.catch(0),console.error("Error handling save/unsave action:",e.t0),t._showNotification("Terjadi kesalahan saat menyimpan/menghapus story");case 45:case"end":return e.stop()}}),e,null,[[0,41]])})));return function(t){return e.apply(this,arguments)}}())}))}),100)}catch(t){console.error("Error setting up save buttons:",t)}}},{key:"showEmptyState",value:function(){var t=document.getElementById("story-list");t&&(t.classList.remove("content-loading"),t.innerHTML='\n      <div class="empty-state">\n        <i class="fas fa-scroll fa-3x"></i>\n        <h3>Belum ada story</h3>\n        <p>Jadilah yang pertama menambahkan story!</p>\n        <a href="#/add-story" class="btn-primary">\n          <i class="fas fa-plus"></i> Tambah Story Baru\n        </a>\n      </div>\n    ')}},{key:"formatDate",value:function(t){return new Date(t).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}},{key:"initMiniMaps",value:function(){document.querySelectorAll(".mini-map").forEach((function(t){var e=t.dataset.lat,n=t.dataset.lon;if(e&&n)try{var r=L.map(t,{zoomControl:!1,attributionControl:!1}).setView([e,n],13),o={OpenStreetMap:L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,minZoom:5}).addTo(r),Satellite:L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{maxZoom:18,minZoom:5}),Carto:L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{maxZoom:20,minZoom:5})},i=L.marker([e,n],{title:"Location: ".concat(parseFloat(e).toFixed(4),", ").concat(parseFloat(n).toFixed(4)),alt:"Story Location",icon:L.icon({iconUrl:"/images/icons/map_marker_x32.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-28]})}).addTo(r),a='\n            <div class="location-popup">\n              <strong>Lokasi Story</strong><br>\n              Koordinat: '.concat(parseFloat(e).toFixed(4),", ").concat(parseFloat(n).toFixed(4),"\n            </div>\n          "),c=L.popup({closeButton:!1,autoClose:!1,closeOnEscapeKey:!1,closeOnClick:!1,className:"custom-popup"}).setContent(a);i.bindPopup(c),L.control.layers(o,{},{collapsed:!0,position:"topright"}).addTo(r);var s=L.Control.extend({options:{position:"topleft"},onAdd:function(t){var e=L.DomUtil.create("div","custom-zoom-control");e.innerHTML='\n                <div class="zoom-button zoom-in" title="Zoom In">\n                  <span class="zoom-symbol">+</span>\n                </div>\n                <div class="zoom-button zoom-out" title="Zoom Out">\n                  <span class="zoom-symbol">−</span>\n                </div>\n              ',e.style.cssText="\n                background: white;\n                padding: 5px;\n                border-radius: 8px;\n                box-shadow: 0 2px 10px rgba(0,0,0,0.15);\n                margin-top: 10px;\n                margin-left: 10px;\n              ",e.querySelectorAll(".zoom-button").forEach((function(t){t.style.cssText="\n                  width: 32px;\n                  height: 32px;\n                  display: flex;\n                  align-items: center;\n                  justify-content: center;\n                  cursor: pointer;\n                  margin: 5px 0;\n                  border-radius: 4px;\n                  transition: all 0.2s ease;\n                  background-color: white;\n                  color: #3498db;\n                  font-size: 20px;\n                  font-weight: bold;\n                ",t.addEventListener("mouseover",(function(){this.style.backgroundColor="#3498db",this.style.color="white",this.style.transform="translateY(-2px)",this.style.boxShadow="0 3px 5px rgba(0,0,0,0.2)"})),t.addEventListener("mouseout",(function(){this.style.backgroundColor="white",this.style.color="#3498db",this.style.transform="translateY(0)",this.style.boxShadow="none"}))})),e.querySelectorAll(".zoom-symbol").forEach((function(t){t.style.cssText="\n                  font-size: 22px;\n                  font-weight: bold;\n                  line-height: 1;\n                "}));var n=e.querySelector(".zoom-in"),r=e.querySelector(".zoom-out");return L.DomEvent.on(n,"click",L.DomEvent.stopPropagation).on(n,"click",L.DomEvent.preventDefault).on(n,"click",(function(){t.zoomIn(1),n.style.transform="scale(0.9)",setTimeout((function(){n.style.transform=""}),100)})),L.DomEvent.on(r,"click",L.DomEvent.stopPropagation).on(r,"click",L.DomEvent.preventDefault).on(r,"click",(function(){t.zoomOut(1),r.style.transform="scale(0.9)",setTimeout((function(){r.style.transform=""}),100)})),e}});r.addControl(new s),t.addEventListener("mouseenter",(function(){i.openPopup()})),t.addEventListener("mouseleave",(function(){setTimeout((function(){return i.closePopup()}),300)})),setTimeout((function(){r.invalidateSize(),i.openPopup(),setTimeout((function(){return i.closePopup()}),100)}),500),L.control.scale({imperial:!1,metric:!0,position:"bottomleft",maxWidth:100}).addTo(r);var u=document.createElement("style");u.textContent="\n            .custom-div-icon {\n              background-color: #2196F3; /* Warna biru yang lebih sesuai dengan gambar */\n              border-radius: 50%;\n              box-shadow: 0 0 0 2px white; /* Border putih di sekitar marker */\n              border: none;\n            }\n\n            .marker-pin {\n              width: 100%;\n              height: 100%;\n              border-radius: 50%;\n            }\n\n            /* Style untuk popup seperti pada gambar */\n            .custom-popup .leaflet-popup-content-wrapper {\n              background-color: white;\n              border-radius: 4px;\n              box-shadow: 0 2px 5px rgba(0,0,0,0.2);\n              padding: 0;\n              border: none;\n            }\n            \n            .custom-popup .leaflet-popup-tip {\n              background-color: white;\n            }\n            \n            .location-popup {\n              padding: 8px 10px;\n              font-family: Arial, sans-serif;\n            }\n            \n            .location-popup .popup-title {\n              color: #673ab7; /* Warna ungu seperti pada gambar */\n              font-size: 14px;\n              font-weight: bold;\n              margin-bottom: 2px;\n            }\n\n            .location-popup .popup-subtitle {\n              font-size: 13px;\n              color: #444;\n            }\n            \n            /* Sembunyikan close button seperti pada gambar */\n            .leaflet-popup-close-button {\n              display: none;\n            }\n          ",document.head.appendChild(u),t.style.height="200px",t.style.borderRadius="8px",t.style.marginTop="15px",t.style.boxShadow="0 4px 8px rgba(0,0,0,0.2)",t.style.border="1px solid #e0e0e0",t.style.position="relative",t.style.overflow="hidden"}catch(e){console.error("Error initializing mini map:",e),t.innerHTML='<div class="map-error">Failed to load map</div>',t.style.height="50px",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.background="#ffdddd",t.style.color="#ff5555",t.style.fontWeight="bold"}}))}},{key:"showError",value:function(t){var e=document.getElementById("story-list");e&&(e.classList.remove("content-loading"),this._isOnline?e.innerHTML='<p class="error">⛔ '.concat(t,"</p>"):e.innerHTML='\n        <div class="offline-state">\n          <i class="fas fa-wifi-slash fa-3x"></i>\n          <h3>Anda sedang offline</h3>\n          <p>Tidak dapat memuat data baru saat ini. Periksa koneksi internet Anda dan coba lagi.</p>\n        </div>\n      ')}},{key:"_loadSavedStoryIds",value:(n=ot(nt().mark((function t(){var e;return nt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.getAllSavedStories();case 3:return e=t.sent,this._savedStoryIds=new Set(e.map((function(t){return t.id}))),t.abrupt("return",this._savedStoryIds);case 8:return t.prev=8,t.t0=t.catch(0),console.error("Error loading saved story IDs:",t.t0),t.abrupt("return",new Set);case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return n.apply(this,arguments)})}],e&&it(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function st(t){return st="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},st(t)}function ut(){ut=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==st(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(st(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function lt(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function ft(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,pt(r.key),r)}}function pt(t){var e=function(t){if("object"!=st(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=st(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==st(e)?e:e+""}var ht=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"processLogin",value:(n=ut().mark((function t(e){var n,r,o;return ut().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.email,r=e.password,t.prev=1,this._validateLoginData({email:n,password:r})){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,s({email:n,password:r});case 6:if((o=t.sent).error){t.next=15;break}return localStorage.setItem("token",o.loginResult.token),localStorage.setItem("userName",o.loginResult.name),this.view.showNotification("success","Login berhasil! Mengalihkan..."),setTimeout((function(){window.location.hash="/"}),1e3),t.abrupt("return",!0);case 15:return this.view.showNotification("error",o.message),t.abrupt("return",!1);case 17:t.next=24;break;case 19:return t.prev=19,t.t0=t.catch(1),this.view.showNotification("error","Terjadi kesalahan, silahkan coba lagi"),console.error("Login error:",t.t0),t.abrupt("return",!1);case 24:case"end":return t.stop()}}),t,this,[[1,19]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){lt(i,r,o,a,c,"next",t)}function c(t){lt(i,r,o,a,c,"throw",t)}a(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"setupPasswordToggle",value:function(t,e){t&&e&&t.addEventListener("click",(function(){var n=t.querySelector("i");"password"===e.type?(e.type="text",n.classList.remove("fa-eye"),n.classList.add("fa-eye-slash")):(e.type="password",n.classList.remove("fa-eye-slash"),n.classList.add("fa-eye"))}))}},{key:"_validateLoginData",value:function(t){var e=t.email,n=t.password;return e&&e.trim()?!!n||(this.view.showNotification("error","Password tidak boleh kosong"),!1):(this.view.showNotification("error","Email tidak boleh kosong"),!1)}}],e&&ft(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function dt(t){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dt(t)}function yt(){yt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==dt(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(dt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function vt(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function mt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){vt(i,r,o,a,c,"next",t)}function c(t){vt(i,r,o,a,c,"throw",t)}a(void 0)}))}}function gt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,bt(r.key),r)}}function bt(t){var e=function(t){if("object"!=dt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==dt(e)?e:e+""}var wt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new ht(this)},e=[{key:"render",value:(r=mt(yt().mark((function t(){return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="auth-container" id="main-content">\n        <div class="auth-card">\n          <div class="auth-header">\n            <div class="auth-logo">\n              <i class="fas fa-book-open"></i>\n            </div>\n            <h1>Login</h1>\n            <p class="auth-subtitle">Silahkan masuk untuk melanjutkan</p>\n          </div>\n          \n          <form id="login-form">\n            <div class="form-group">\n              <label for="email">\n                <i class="fas fa-envelope"></i> Email\n              </label>\n              <input type="email" id="email" name="email" placeholder="Masukkan email" required>\n            </div>\n            \n            <div class="form-group">\n              <label for="password">\n                <i class="fas fa-lock"></i> Password\n              </label>\n              <div class="password-field">\n                <input type="password" id="password" name="password" placeholder="Masukkan password" required>\n                <button type="button" class="toggle-password" aria-label="Tampilkan password">\n                  <i class="fas fa-eye"></i>\n                </button>\n              </div>\n            </div>\n            \n            <div class="form-actions">\n              <button type="submit" class="btn-submit">\n                <i class="fas fa-sign-in-alt"></i> Login\n              </button>\n            </div>\n            \n            <div class="auth-footer">\n              <span>Belum punya akun? <a href="#/register" class="auth-link">Daftar</a></span>\n            </div>\n          </form>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=mt(yt().mark((function t(){var e,n,r,o=this;return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:H.setupUnauthenticatedNavigation(),e=document.querySelector("#login-form"),n=document.querySelector("#password"),r=document.querySelector(".toggle-password"),this.presenter.setupPasswordToggle(r,n),e.addEventListener("submit",function(){var t=mt(yt().mark((function t(n){var r,i,a,c;return yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r=e.querySelector('button[type="submit"]'),i=r.innerHTML,r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Memproses...',r.disabled=!0,t.prev=5,a=e.email.value,c=e.password.value,t.next=10,o.presenter.processLogin({email:a,password:c});case 10:t.sent||(r.innerHTML=i,r.disabled=!1),t.next=18;break;case 14:t.prev=14,t.t0=t.catch(5),r.innerHTML=i,r.disabled=!1;case 18:case"end":return t.stop()}}),t,null,[[5,14]])})));return function(e){return t.apply(this,arguments)}}());case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showNotification",value:function(t,e){var n=document.querySelector(".auth-notification");n&&n.remove();var r=document.createElement("div");r.className="auth-notification ".concat(t),r.innerHTML='\n      <i class="fas '.concat("success"===t?"fa-check-circle":"fa-exclamation-circle",'"></i>\n      ').concat(e,"\n    ");var o=document.querySelector("#login-form");o.insertBefore(r,o.querySelector(".form-actions")),"error"===t&&setTimeout((function(){r.classList.add("fade-out"),setTimeout((function(){return r.remove()}),500)}),3e3)}}],e&&gt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function xt(t){return xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},xt(t)}function kt(){kt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==xt(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(xt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Lt(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Et(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,St(r.key),r)}}function St(t){var e=function(t){if("object"!=xt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==xt(e)?e:e+""}var _t=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"processRegistration",value:(n=kt().mark((function t(e){var n,r,o,i;return kt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=e.name,r=e.email,o=e.password,t.prev=1,this._validateRegistrationData({name:n,email:r,password:o})){t.next=4;break}return t.abrupt("return",!1);case 4:return t.next=6,a({name:n,email:r,password:o});case 6:if((i=t.sent).error){t.next=13;break}return this.view.showNotification("success","Registrasi berhasil! Mengalihkan ke halaman login..."),setTimeout((function(){window.location.hash="/login"}),2e3),t.abrupt("return",!0);case 13:return this.view.showNotification("error",i.message),t.abrupt("return",!1);case 15:t.next=22;break;case 17:return t.prev=17,t.t0=t.catch(1),this.view.showNotification("error","Terjadi kesalahan, silahkan coba lagi"),console.error("Registration error:",t.t0),t.abrupt("return",!1);case 22:case"end":return t.stop()}}),t,this,[[1,17]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){Lt(i,r,o,a,c,"next",t)}function c(t){Lt(i,r,o,a,c,"throw",t)}a(void 0)}))},function(t){return r.apply(this,arguments)})},{key:"setupPasswordToggle",value:function(t,e){t&&e&&t.addEventListener("click",(function(){var t=this.querySelector("i");"password"===e.type?(e.type="text",t.classList.remove("fa-eye"),t.classList.add("fa-eye-slash")):(e.type="password",t.classList.remove("fa-eye-slash"),t.classList.add("fa-eye"))}))}},{key:"setupPasswordStrengthMeter",value:function(t,e){t&&e&&t.addEventListener("input",(function(){var t=this.value,n=0;t.length>=8&&(n+=20),t.match(/[a-z]+/)&&(n+=20),t.match(/[A-Z]+/)&&(n+=20),t.match(/[0-9]+/)&&(n+=20),t.match(/[^a-zA-Z0-9]+/)&&(n+=20);var r;r=n<=40?"#ff4d4d":n<=60?"#ffd633":"#47d147",e.style.width=n+"%",e.style.backgroundColor=r}))}},{key:"_validateRegistrationData",value:function(t){var e=t.name,n=t.email,r=t.password;return e&&e.trim()?n&&n.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(n)?!(!r||r.length<8)||(this.view.showNotification("error","Password minimal 8 karakter"),!1):(this.view.showNotification("error","Format email tidak valid"),!1):(this.view.showNotification("error","Email tidak boleh kosong"),!1):(this.view.showNotification("error","Nama tidak boleh kosong"),!1)}}],e&&Et(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Ot(t){return Ot="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ot(t)}function jt(){jt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Ot(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(Ot(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Tt(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Pt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Tt(i,r,o,a,c,"next",t)}function c(t){Tt(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Nt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,It(r.key),r)}}function It(t){var e=function(t){if("object"!=Ot(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Ot(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Ot(e)?e:e+""}var At=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new _t(this)},e=[{key:"render",value:(r=Pt(jt().mark((function t(){return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="auth-container" id="main-content">\n        <div class="auth-card">\n          <div class="auth-header">\n            <div class="auth-logo">\n              <i class="fas fa-user-plus"></i>\n            </div>\n            <h1>Register</h1>\n            <p class="auth-subtitle">Buat akun untuk memulai</p>\n          </div>\n          \n          <form id="register-form">\n            <div class="form-group">\n              <label for="name">\n                <i class="fas fa-user"></i> Nama\n              </label>\n              <input type="text" id="name" name="name" placeholder="Masukkan nama lengkap" required>\n            </div>\n            \n            <div class="form-group">\n              <label for="email">\n                <i class="fas fa-envelope"></i> Email\n              </label>\n              <input type="email" id="email" name="email" placeholder="Masukkan email" required>\n            </div>\n            \n            <div class="form-group">\n              <label for="password">\n                <i class="fas fa-lock"></i> Password\n              </label>\n              <div class="password-field">\n                <input type="password" id="password" name="password" placeholder="Minimal 8 karakter" minlength="8" required>\n                <button type="button" class="toggle-password" aria-label="Tampilkan password">\n                  <i class="fas fa-eye"></i>\n                </button>\n              </div>\n              <div class="password-strength" id="password-strength">\n                <span class="strength-label">Kekuatan Password:</span>\n                <div class="strength-meter">\n                  <div class="strength-bar" id="strength-bar"></div>\n                </div>\n              </div>\n            </div>\n            \n            <div class="form-actions">\n              <button type="submit" class="btn-submit">\n                <i class="fas fa-user-plus"></i> Register\n              </button>\n            </div>\n            \n            <div class="auth-footer">\n              <span>Sudah punya akun? <a href="#/login" class="auth-link">Login</a></span>\n            </div>\n          </form>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=Pt(jt().mark((function t(){var e,n,r,o,i=this;return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:H.setupUnauthenticatedNavigation(),e=document.querySelector("#register-form"),n=document.getElementById("password"),r=document.getElementById("strength-bar"),o=document.querySelector(".toggle-password"),this.presenter.setupPasswordToggle(o,n),this.presenter.setupPasswordStrengthMeter(n,r),e.addEventListener("submit",function(){var t=Pt(jt().mark((function t(n){var r,o,a,c,s;return jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n.preventDefault(),r=e.querySelector('button[type="submit"]'),o=r.innerHTML,r.innerHTML='<i class="fas fa-spinner fa-spin"></i> Memproses...',r.disabled=!0,t.prev=5,a=e.name.value,c=e.email.value,s=e.password.value,t.next=11,i.presenter.processRegistration({name:a,email:c,password:s});case 11:t.sent||(r.innerHTML=o,r.disabled=!1),t.next=19;break;case 15:t.prev=15,t.t0=t.catch(5),r.innerHTML=o,r.disabled=!1;case 19:case"end":return t.stop()}}),t,null,[[5,15]])})));return function(e){return t.apply(this,arguments)}}());case 8:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"showNotification",value:function(t,e){var n=document.querySelector(".auth-notification");n&&n.remove();var r=document.createElement("div");r.className="auth-notification ".concat(t),r.innerHTML='\n      <i class="fas '.concat("success"===t?"fa-check-circle":"fa-exclamation-circle",'"></i>\n      ').concat(e,"\n    ");var o=document.querySelector("#register-form");o.insertBefore(r,o.querySelector(".form-actions")),"error"===t&&setTimeout((function(){r.classList.add("fade-out"),setTimeout((function(){return r.remove()}),500)}),3e3)}}],e&&Nt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Gt(t){return Gt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Gt(t)}function Ct(){Ct=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Gt(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(Gt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Ft(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Bt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ft(i,r,o,a,c,"next",t)}function c(t){Ft(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Mt(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,zt(r.key),r)}}function zt(t){var e=function(t){if("object"!=Gt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Gt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Gt(e)?e:e+""}var Dt=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"initCamera",value:(o=Bt(Ct().mark((function t(){var e,n;return Ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,e={video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}},t.next=4,navigator.mediaDevices.getUserMedia(e);case 4:n=t.sent,this.view.showCameraPreview(n),t.next=12;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Camera access error:",t.t0),this.view.showError("Tidak dapat mengakses kamera. Silakan gunakan opsi upload file.");case 12:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(){return o.apply(this,arguments)})},{key:"capturePhoto",value:(r=Bt(Ct().mark((function t(e){var n,r,o;return Ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e){t.next=2;break}return t.abrupt("return",null);case 2:return n=document.createElement("canvas"),r=e.videoWidth,o=e.videoHeight,n.width=r,n.height=o,n.getContext("2d").drawImage(e,0,0,r,o),t.abrupt("return",new Promise((function(t){n.toBlob(t,"image/jpeg",.9)})));case 9:case"end":return t.stop()}}),t)}))),function(t){return r.apply(this,arguments)})},{key:"submitStory",value:(n=Bt(Ct().mark((function t(e){var n;return Ct().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,this._validateStoryData(e),t.next=4,l(e);case 4:(n=t.sent).error?this.view.showError(n.message||"Gagal mengunggah story"):this.view.redirectToHome(),t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),this.view.showError(t.t0.message||"Gagal mengunggah story");case 11:case"end":return t.stop()}}),t,this,[[0,8]])}))),function(t){return n.apply(this,arguments)})},{key:"_validateStoryData",value:function(t){if(!t.description)throw new Error("Deskripsi wajib diisi");if(!t.photo)throw new Error("Foto wajib diisi");if(t.lat&&!t.lon||!t.lat&&t.lon)throw new Error("Koordinat lokasi tidak lengkap")}}],e&&Mt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function Yt(){Yt=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==qt(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(qt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Ht(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Rt(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ht(i,r,o,a,c,"next",t)}function c(t){Ht(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Ut(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Wt(r.key),r)}}function Wt(t){var e=function(t){if("object"!=qt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qt(e)?e:e+""}var Jt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new Dt(this),this.videoElement=null,this.capturedImageBlob=null,this.isCameraMode=!1},e=[{key:"render",value:(r=Rt(Yt().mark((function t(){return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'      \n      <section class="container" id="main-content">\n        <h1>Tambah Story</h1>\n        <form id="add-story-form">\n          <div class="form-group">\n            <label for="description">Deskripsi</label>\n            <textarea id="description" name="description" required></textarea>\n          </div>\n          \n          <div class="photo-input-container">\n            <label>Foto</label>\n            <div class="photo-method-selector">\n              <p class="photo-method-instruction">Pilih salah satu metode untuk menambahkan foto:</p>\n              \n              <div class="photo-method">\n                <h3><i class="fas fa-file-upload"></i> Upload Foto</h3>\n                <p class="photo-method-description">Upload foto dari perangkat Anda</p>\n                <div class="photo-actions">\n                  <input type="file" id="photo" name="photo" accept="image/*" class="file-input">\n                </div>\n              </div>\n              \n              <div class="photo-method-divider">\n                <span>atau</span>\n              </div>\n              \n              <div class="photo-method">\n                <h3><i class="fas fa-camera"></i> Tangkap Foto</h3>\n                <p class="photo-method-description">Gunakan kamera untuk mengambil foto baru</p>\n                <div class="photo-actions">\n                  <button type="button" id="camera-btn" class="camera-toggle-btn">\n                    <i class="fas fa-camera"></i> Buka Kamera\n                  </button>\n                </div>\n              </div>\n            </div>\n            \n            <div id="camera-container" class="camera-container" style="display: none;">\n              <video id="camera-preview" class="camera-preview"></video>\n              <div class="camera-controls">\n                <button type="button" id="capture-btn" class="camera-button">\n                  <i class="fas fa-camera"></i> Tangkap Foto\n                </button>\n                <button type="button" id="close-camera-btn" class="camera-close-btn">\n                  <i class="fas fa-times"></i> Tutup Kamera\n                </button>\n              </div>\n            </div>\n            \n            <div id="preview-container" style="display: none;">\n              <h3 class="preview-title"><i class="fas fa-check-circle"></i> Foto Dipilih</h3>\n              <img id="photo-preview" alt="Preview foto">\n              <button type="button" id="retake-btn" class="retake-btn">\n                <i class="fas fa-redo"></i> Pilih Foto Lain\n              </button>\n            </div>\n          </div>\n          \n          <div class="form-group">\n            <label for="map">Pilih Lokasi di Peta (Opsional)</label>\n            <p class="map-instructions">Klik pada peta untuk menentukan lokasi story Anda</p>\n            <div id="map" style="height: 300px; margin-top: 10px;"></div>\n            <input type="hidden" id="lat" name="lat">\n            <input type="hidden" id="lon" name="lon">\n          </div>\n          \n          <button type="submit">Tambah Story</button>\n        </form>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=Rt(Yt().mark((function t(){var e=this;return Yt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:H.setupAuthenticatedNavigation(),this._initMap(),this._initFormElements(),this._initEventListeners(),window.addEventListener("hashchange",(function(){return e.stopCameraStream()})),window.addEventListener("beforeunload",(function(){return e.stopCameraStream()}));case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"_initMap",value:function(){if(document.getElementById("map"))try{var t,e=L.map("map").setView([-2.5489,118.0149],5),n={OpenStreetMap:L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a>',className:"map-layer-osm"}),Satellite:L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:'&copy; <a href="https://www.esri.com/">Esri</a>',className:"map-layer-satellite"}),Carto:L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://carto.com/">CARTO</a>',className:"map-layer-carto"})};n.OpenStreetMap.addTo(e),L.control.layers(n,null,{collapsed:!1,sortLayers:!1,position:"topright"}).addTo(e),this._customizeLayerControl(),e.on("click",(function(n){var r=n.latlng,o=r.lat,i=r.lng;t?t.setLatLng([o,i]):(t=L.marker([o,i]).addTo(e)).bindPopup("Lokasi story Anda").openPopup(),document.getElementById("lat").value=o,document.getElementById("lon").value=i})),this._tryGetApproximateLocation(e)}catch(t){console.error("Error initializing map:",t)}}},{key:"_customizeLayerControl",value:function(){setTimeout((function(){var t=document.querySelector(".leaflet-control-layers");t&&(t.classList.add("map-layer-control-custom"),t.querySelectorAll('input[type="radio"]').forEach((function(t,e){var n=t.nextElementSibling;if(n){var r="";0===e?r="fas fa-map":1===e?r="fas fa-satellite":2===e&&(r="fas fa-globe");var o=document.createElement("span");o.className="custom-map-layer-item ".concat(t.checked?"active":""),o.innerHTML='<i class="'.concat(r,'"></i> ').concat(n.textContent),o.addEventListener("click",(function(){t.click(),document.querySelectorAll(".custom-map-layer-item").forEach((function(t){t.classList.remove("active")})),o.classList.add("active")})),n.parentNode.insertBefore(o,n),n.style.display="none",t.style.display="none"}})))}),100)}},{key:"_tryGetApproximateLocation",value:function(t){try{t.setView([-.7893,113.9213],5)}catch(t){console.log("Could not set default location:",t)}}},{key:"_initFormElements",value:function(){var t=this;this.form=document.querySelector("#add-story-form"),this.photoInput=document.getElementById("photo"),this.cameraBtn=document.getElementById("camera-btn"),this.closeCameraBtn=document.getElementById("close-camera-btn"),this.cameraContainer=document.getElementById("camera-container"),this.previewContainer=document.getElementById("preview-container"),this.photoPreview=document.getElementById("photo-preview"),this.photoInput&&this.photoInput.addEventListener("change",(function(){t.photoInput.files&&t.photoInput.files[0]&&t._showImagePreview(URL.createObjectURL(t.photoInput.files[0]))}))}},{key:"_initEventListeners",value:function(){var t=this;this.cameraBtn&&this.cameraBtn.addEventListener("click",(function(){t.isCameraMode=!0,document.querySelector(".photo-method-selector").style.display="none",t.cameraContainer.style.display="block",t.presenter.initCamera()})),this.closeCameraBtn&&this.closeCameraBtn.addEventListener("click",(function(){t.isCameraMode=!1,document.querySelector(".photo-method-selector").style.display="block",t.cameraContainer.style.display="none",t.stopCameraStream()}));var e=document.getElementById("capture-btn");e&&e.addEventListener("click",Rt(Yt().mark((function e(){var n;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.presenter.capturePhoto(t.videoElement);case 2:t.capturedImageBlob=e.sent,n=URL.createObjectURL(t.capturedImageBlob),t._showImagePreview(n);case 5:case"end":return e.stop()}}),e)}))));var n=document.getElementById("retake-btn");n&&n.addEventListener("click",(function(){t.capturedImageBlob=null,t.previewContainer.style.display="none",document.querySelector(".photo-method-selector").style.display="block",t.cameraContainer.style.display="none",t.photoInput.value=""})),this.form&&this.form.addEventListener("submit",function(){var e=Rt(Yt().mark((function e(n){var r;return Yt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),r={description:t.form.description.value,lat:t.form.lat.value,lon:t.form.lon.value,token:localStorage.getItem("token")},!t.capturedImageBlob){e.next=6;break}r.photo=new File([t.capturedImageBlob],"photo.jpg",{type:"image/jpeg"}),e.next=12;break;case 6:if(!t.photoInput.files||!t.photoInput.files[0]){e.next=10;break}r.photo=t.photoInput.files[0],e.next=12;break;case 10:return alert("Harap pilih atau ambil foto terlebih dahulu"),e.abrupt("return");case 12:if(r.token){e.next=15;break}return window.location.hash="/login",e.abrupt("return");case 15:return e.next=17,t.presenter.submitStory(r);case 17:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())}},{key:"_showImagePreview",value:function(t){this.photoPreview&&this.previewContainer&&(this.photoPreview.src=t,document.querySelector(".photo-method-selector").style.display="none",this.cameraContainer.style.display="none",this.previewContainer.style.display="block",this.stopCameraStream())}},{key:"showCameraPreview",value:function(t){this.videoElement=document.getElementById("camera-preview"),this.videoElement&&(this.videoElement.srcObject=t,this.videoElement.play())}},{key:"stopCameraStream",value:function(){this.videoElement&&this.videoElement.srcObject&&(this.videoElement.srcObject.getTracks().forEach((function(t){return t.stop()})),this.videoElement.srcObject=null)}},{key:"showError",value:function(t){alert(t)}},{key:"redirectToHome",value:function(){this.stopCameraStream(),window.location.hash="/"}}],e&&Ut(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Zt(t){var e=t.split("/");return{resource:e[1]||null,id:e[2]||null}}function Kt(){return location.hash.replace("#","")||"/"}function Vt(){return t=Zt(Kt()),e="",t.resource&&(e=e.concat("/".concat(t.resource))),t.id&&(e=e.concat("/:id")),e||"/";var t,e}function Xt(t){return Xt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Xt(t)}function $t(){$t=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Xt(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(Xt(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Qt(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function te(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ee(r.key),r)}}function ee(t){var e=function(t){if("object"!=Xt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Xt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Xt(e)?e:e+""}var ne=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e,this.story=null},e=[{key:"loadStoryDetail",value:(n=$t().mark((function t(){var e,n,r,o;return $t().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=Zt(Kt()),n=e.id,r=localStorage.getItem("token")){t.next=6;break}return window.location.hash="/login",t.abrupt("return",!1);case 6:return t.next=8,d(n,r);case 8:if(!(o=t.sent).error){t.next=12;break}return this.view.showError(o.message),t.abrupt("return",!1);case 12:return this.story=o.story,this.view.displayStoryDetail(this.story),this.story.lat&&this.story.lon&&this.view.initMap(this.story),t.abrupt("return",!0);case 18:return t.prev=18,t.t0=t.catch(0),console.error("Error loading story detail:",t.t0),this.view.showError("Terjadi kesalahan saat memuat detail story"),t.abrupt("return",!1);case 23:case"end":return t.stop()}}),t,this,[[0,18]])})),r=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){Qt(i,r,o,a,c,"next",t)}function c(t){Qt(i,r,o,a,c,"throw",t)}a(void 0)}))},function(){return r.apply(this,arguments)})},{key:"hasLocation",value:function(){return this.story&&this.story.lat&&this.story.lon}}],e&&te(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}(),re=function(){var t=document.getElementById("main-content");t&&"-1"!==t.getAttribute("tabindex")&&t.setAttribute("tabindex","-1"),t&&t.addEventListener("focus",(function(){t.setAttribute("aria-live","polite"),setTimeout((function(){t.removeAttribute("aria-live")}),1e3)}))};function oe(t){return oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},oe(t)}function ie(){ie=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==oe(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(oe(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function ae(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function ce(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ae(i,r,o,a,c,"next",t)}function c(t){ae(i,r,o,a,c,"throw",t)}a(void 0)}))}}function se(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,ue(r.key),r)}}function ue(t){var e=function(t){if("object"!=oe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=oe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==oe(e)?e:e+""}var le=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new ne(this),this._isStorySaved=!1},e=[{key:"render",value:(o=ce(ie().mark((function t(){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="story-detail" id="main-content">\n        <div class="loading-container">\n          <div class="loading-spinner"></div>\n          <p>Loading story details...</p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(r=ce(ie().mark((function t(){return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return H.setupAuthenticatedNavigation(),t.next=3,this.presenter.loadStoryDetail();case 3:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"displayStoryDetail",value:(n=ce(ie().mark((function t(e){var n,r,o,i,a;return ie().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=document.querySelector(".story-detail")){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,tt.isStorySaved(e.id);case 5:this._isStorySaved=t.sent,r=this._isStorySaved?"Hapus dari Tersimpan":"Simpan Story",o=this._isStorySaved?"fa-trash":"fa-bookmark",i=this._isStorySaved?"btn-unsave":"btn-save",n.innerHTML='\n      <div class="detail-header">\n        <h1>'.concat(e.name,'\'s Story</h1>\n        <div class="meta-info">\n          <span class="date">').concat((c=e.createdAt,new Date(c).toLocaleDateString("id-ID",{weekday:"long",year:"numeric",month:"long",day:"numeric"})),'</span>\n          <span class="location">\n            <i class="fas fa-map-marker-alt"></i>\n            ').concat(e.lat&&e.lon?"".concat(e.lat,", ").concat(e.lon):"Lokasi tidak tersedia",'\n          </span>\n        </div>\n      </div>\n      \n      <div class="content-grid">\n        <div class="image-container">\n          <img src="').concat(e.photoUrl,'" alt="').concat(e.description,'">\n        </div>\n        \n        <div class="description-card">\n          <h2>Story Description</h2>\n          <p>').concat(e.description,"</p>\n        </div>\n        \n        ").concat(e.lat&&e.lon?'\n        <div class="map-card">\n          <h2>Story Location</h2>\n          <div id="map"></div>\n        </div>\n        ':"",'\n      </div>\n      \n      <div class="story-actions">\n        <a href="#/" class="btn-back">\n          <i class="fas fa-arrow-left"></i> Back to Stories\n        </a>\n        <button id="save-story-button" class="').concat(i,'">\n          <i class="fas ').concat(o,'"></i> ').concat(r,"\n        </button>\n      </div>\n    "),(a=document.createElement("style")).textContent="\n      .story-actions {\n        display: flex;\n        justify-content: space-between;\n        margin-top: 20px;\n      }\n      \n      .btn-save, .btn-unsave {\n        padding: 10px 16px;\n        border-radius: 6px;\n        cursor: pointer;\n        font-weight: 500;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        transition: all 0.3s ease;\n        border: none;\n      }\n      \n      .btn-save {\n        background-color: #3498db;\n        color: white;\n      }\n      \n      .btn-save:hover {\n        background-color: #2980b9;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n      }\n      \n      .btn-unsave {\n        background-color: #e74c3c;\n        color: white;\n      }\n      \n      .btn-unsave:hover {\n        background-color: #c0392b;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 8px rgba(0,0,0,0.1);\n      }\n      \n      .toast-notification {\n        position: fixed;\n        bottom: 20px;\n        left: 50%;\n        transform: translateX(-50%);\n        background-color: #2ecc71;\n        color: white;\n        padding: 15px 25px;\n        border-radius: 8px;\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n        z-index: 1000;\n        opacity: 1;\n        transition: opacity 0.3s ease, transform 0.3s ease;\n      }\n\n      .toast-notification.hidden {\n        opacity: 0;\n        transform: translate(-50%, 20px);\n      }\n    ",document.head.appendChild(a),this._setupSaveButtonListener(e),e.lat&&e.lon&&this.initMap(e);case 15:case"end":return t.stop()}var c}),t,this)}))),function(t){return n.apply(this,arguments)})},{key:"_setupSaveButtonListener",value:function(t){var e=this,n=document.getElementById("save-story-button");n&&n.addEventListener("click",ce(ie().mark((function r(){return ie().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(r.prev=0,!e._isStorySaved){r.next=11;break}return r.next=4,tt.deleteSavedStory(t.id);case 4:e._showNotification("Story berhasil dihapus dari tersimpan"),n.innerHTML='<i class="fas fa-bookmark"></i> Simpan Story',n.classList.remove("btn-unsave"),n.classList.add("btn-save"),e._isStorySaved=!1,r.next=18;break;case 11:return r.next=13,tt.saveStory(t);case 13:e._showNotification("Story berhasil disimpan"),n.innerHTML='<i class="fas fa-trash"></i> Hapus dari Tersimpan',n.classList.remove("btn-save"),n.classList.add("btn-unsave"),e._isStorySaved=!0;case 18:r.next=24;break;case 20:r.prev=20,r.t0=r.catch(0),console.error("Error toggling story save state:",r.t0),e._showNotification("Terjadi kesalahan saat menyimpan story");case 24:case"end":return r.stop()}}),r,null,[[0,20]])}))))}},{key:"_showNotification",value:function(t){try{var e=document.querySelector(".toast-notification");e||((e=document.createElement("div")).className="toast-notification hidden",document.body.appendChild(e)),setTimeout((function(){e&&(e.textContent=t,e.classList.remove("hidden"),setTimeout((function(){e&&e.classList.add("hidden")}),3e3))}),0)}catch(t){console.error("Error showing notification:",t)}}},{key:"initMap",value:function(t){if(document.getElementById("map"))try{var e=L.map("map").setView([t.lat,t.lon],13),n=L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',maxZoom:19}).addTo(e),r=L.tileLayer("https://{s}.tile.opentopomap.org/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://opentopomap.org">OpenTopoMap</a> contributors',maxZoom:17}),o=L.tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:'&copy; <a href="https://www.esri.com/">Esri</a>',maxZoom:18}),i=L.tileLayer("https://{s}.basemaps.cartocdn.com/rastertiles/voyager/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://carto.com/">CARTO</a>',maxZoom:20}),a=L.tileLayer("https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png",{attribution:'&copy; <a href="https://carto.com/">CARTO</a>',maxZoom:19}),c=L.tileLayer("https://tiles.openseamap.org/seamark/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openseamap.org/">OpenSeaMap</a>',maxZoom:18}),s=L.tileLayer("https://www.openptmap.org/tiles/{z}/{x}/{y}.png",{attribution:'&copy; <a href="https://www.openptmap.org/">OpenPtMap</a>',maxZoom:17,opacity:.7});L.marker([t.lat,t.lon]).addTo(e).bindPopup("<b>".concat(t.name,"</b><br>").concat(t.description)).openPopup(),L.circle([t.lat,t.lon],{color:"#3498db",fillColor:"#3498db",fillOpacity:.2,radius:500}).addTo(e);var u={OpenStreetMap:n,OpenTopoMap:r,Satellite:o,"Carto Voyager":i,"Carto Dark":a},l={"Nautical Information":c,"Public Transport":s};L.control.layers(u,l,{collapsed:!0}).addTo(e),L.control.scale({imperial:!1,metric:!0}).addTo(e)}catch(t){console.error("Error initializing map:",t)}}},{key:"showError",value:function(t){var e=document.querySelector(".story-detail");e&&(e.innerHTML='\n      <section class="container" id="error-content">\n        <div class="error-container">\n          <i class="fas fa-exclamation-triangle"></i>\n          <p class="error">Error: '.concat(t,'</p>\n          <a href="#/" class="btn-primary">Kembali ke Beranda</a>\n        </div>\n      </section>\n    '))}}],e&&se(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function fe(t){return fe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fe(t)}function pe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,he(r.key),r)}}function he(t){var e=function(t){if("object"!=fe(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=fe(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==fe(e)?e:e+""}var de=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},(e=[{key:"getAppInfo",value:function(){return{name:"Myriadn Story App",description:"Platform berbagi cerita yang memungkinkan pengguna untuk membagikan momen dan pengalaman mereka melalui foto dan teks.",features:[{icon:"fa-camera",title:"Ambil Foto",description:"Ambil foto secara langsung dari kamera perangkat Anda atau unggah dari galeri."},{icon:"fa-map-marker-alt",title:"Lokasi",description:"Tandai lokasi cerita Anda pada peta untuk berbagi tempat spesial."},{icon:"fa-share-alt",title:"Berbagi Cerita",description:"Bagikan cerita Anda dengan semua orang dalam komunitas."}],githubUrl:"https://github.com/myriadn"}}},{key:"setupNavigation",value:function(){localStorage.getItem("token")?this.view.setupAuthenticatedNavigation():this.view.setupUnauthenticatedNavigation()}}])&&pe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();function ye(t){return ye="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ye(t)}function ve(){ve=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==ye(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(ye(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function me(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function ge(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){me(i,r,o,a,c,"next",t)}function c(t){me(i,r,o,a,c,"throw",t)}a(void 0)}))}}function be(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,we(r.key),r)}}function we(t){var e=function(t){if("object"!=ye(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ye(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ye(e)?e:e+""}var xe=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new de(this)},e=[{key:"render",value:(r=ge(ve().mark((function t(){var e;return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.presenter.getAppInfo(),t.abrupt("return",'\n      <section class="container about-page" id="main-content">\n        <h1>About '.concat(e.name,'</h1>\n        \n        <div class="about-content">\n          <p>').concat(e.description,'</p>\n        </div>\n        \n        <div class="about-features">\n          ').concat(e.features.map((function(t){return'\n            <div class="feature-card">\n              <i class="fas '.concat(t.icon,'"></i>\n              <h3>').concat(t.title,"</h3>\n              <p>").concat(t.description,"</p>\n            </div>\n          ")})).join(""),'\n        </div>\n        \n        <div class="github-card">\n          <i class="fab fa-github"></i>\n          <a href="').concat(e.githubUrl,'" target="_blank">\n            ').concat(e.githubUrl.replace("https://",""),"\n          </a>\n        </div>\n      </section>\n    "));case 2:case"end":return t.stop()}}),t,this)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=ge(ve().mark((function t(){return ve().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.presenter.setupNavigation();case 1:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"setupAuthenticatedNavigation",value:function(){H.setupAuthenticatedNavigation()}},{key:"setupUnauthenticatedNavigation",value:function(){H.setupUnauthenticatedNavigation()}}],e&&be(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function ke(t){return ke="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ke(t)}function Le(){Le=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==ke(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(ke(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Ee(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Se(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ee(i,r,o,a,c,"next",t)}function c(t){Ee(i,r,o,a,c,"throw",t)}a(void 0)}))}}function _e(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Oe(r.key),r)}}function Oe(t){var e=function(t){if("object"!=ke(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=ke(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ke(e)?e:e+""}var je=function(){return t=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.view=e},e=[{key:"loadSavedStories",value:(o=Se(Le().mark((function t(){var e,n,r,o=arguments;return Le().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:"savedAt",n=o.length>1&&void 0!==o[1]&&o[1],t.prev=2,t.next=5,tt.getAllSavedStories(e,n);case 5:r=t.sent,this.view.displaySavedStories(r),t.next=13;break;case 9:t.prev=9,t.t0=t.catch(2),console.error("Error loading saved stories:",t.t0),this.view.showError("Gagal memuat daftar story tersimpan");case 13:case"end":return t.stop()}}),t,this,[[2,9]])}))),function(){return o.apply(this,arguments)})},{key:"deleteSavedStory",value:(r=Se(Le().mark((function t(e){return Le().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.deleteSavedStory(e);case 3:if(!t.sent){t.next=10;break}return this.view._showNotification("Story berhasil dihapus dari tersimpan"),t.next=8,this.loadSavedStories();case 8:t.next=11;break;case 10:this.view._showNotification("Gagal menghapus story");case 11:t.next=17;break;case 13:t.prev=13,t.t0=t.catch(0),console.error("Error deleting saved story:",t.t0),this.view._showNotification("Terjadi kesalahan saat menghapus story");case 17:case"end":return t.stop()}}),t,this,[[0,13]])}))),function(t){return r.apply(this,arguments)})},{key:"clearAllSavedStories",value:(n=Se(Le().mark((function t(){return Le().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,tt.clearAllSavedStories();case 3:t.sent?(this.view._showNotification("Semua story tersimpan berhasil dihapus"),this.view.showEmptyState()):this.view._showNotification("Gagal menghapus semua story tersimpan"),t.next=11;break;case 7:t.prev=7,t.t0=t.catch(0),console.error("Error clearing saved stories:",t.t0),this.view._showNotification("Terjadi kesalahan saat menghapus semua story");case 11:case"end":return t.stop()}}),t,this,[[0,7]])}))),function(){return n.apply(this,arguments)})}],e&&_e(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r,o}();function Te(t){return Te="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Te(t)}function Pe(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=Array(e);n<e;n++)r[n]=t[n];return r}function Ne(){Ne=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Te(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(Te(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Ie(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Ae(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ie(i,r,o,a,c,"next",t)}function c(t){Ie(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Ge(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ce(r.key),r)}}function Ce(t){var e=function(t){if("object"!=Te(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Te(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Te(e)?e:e+""}var Fe=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.presenter=new je(this),this._isOnline=navigator.onLine},e=[{key:"render",value:(r=Ae(Ne().mark((function t(){return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container saved-stories-container" id="main-content">\n        <div class="page-header">\n          <h1><i class="fas fa-bookmark"></i> Story Tersimpan</h1>\n          <p class="subtitle">Daftar story yang Anda simpan untuk dibaca nanti</p>\n        </div>\n        \n        <div id="saved-stories-controls" class="saved-stories-controls">\n          <div class="sorting-options">\n            <label for="sorting">Urutkan berdasarkan:</label>\n            <select id="sorting" class="sort-select">\n              <option value="savedAt-desc">Terbaru Disimpan</option>\n              <option value="savedAt-asc">Terlama Disimpan</option>\n              <option value="createdAt-desc">Terbaru Dibuat</option>\n              <option value="createdAt-asc">Terlama Dibuat</option>\n              <option value="name-asc">Nama (A-Z)</option>\n              <option value="name-desc">Nama (Z-A)</option>\n            </select>\n          </div>\n          <button id="clearAllSaved" class="btn btn-danger">\n            <i class="fas fa-trash"></i> Hapus Semua\n          </button>\n        </div>\n        \n        \x3c!-- App Shell untuk menampilkan konten saat loading atau offline --\x3e\n        <div id="saved-story-list" class="content-loading">\n          <div class="app-shell-skeleton"></div>\n          <div class="app-shell-skeleton"></div>\n          <div class="app-shell-skeleton"></div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=Ae(Ne().mark((function t(){return Ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:H.setupAuthenticatedNavigation(),this._setupOnlineOfflineHandler(),this._setupSortingHandler(),this._setupClearAllButton(),this.presenter.loadSavedStories();case 5:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"_setupOnlineOfflineHandler",value:function(){var t=this;window.addEventListener("online",(function(){t._isOnline=!0,t._showNotification("Anda kembali online")})),window.addEventListener("offline",(function(){t._isOnline=!1,t._showNotification("Anda sedang offline. Anda masih dapat melihat story tersimpan.")}))}},{key:"_setupSortingHandler",value:function(){var t=this,e=document.getElementById("sorting");e&&e.addEventListener("change",(function(){var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var r,o,i,a,c=[],s=!0,u=!1;try{if(i=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;s=!1}else for(;!(s=(r=i.call(n)).done)&&(c.push(r.value),c.length!==e);s=!0);}catch(t){u=!0,o=t}finally{try{if(!s&&null!=n.return&&(a=n.return(),Object(a)!==a))return}finally{if(u)throw o}}return c}}(t,e)||function(t,e){if(t){if("string"==typeof t)return Pe(t,e);var n={}.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Pe(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.value.split("-"),2),r=n[0],o="asc"===n[1];t.presenter.loadSavedStories(r,o)}))}},{key:"_setupClearAllButton",value:function(){var t=this,e=document.getElementById("clearAllSaved");e&&e.addEventListener("click",(function(){confirm("Apakah Anda yakin ingin menghapus semua story tersimpan?")&&(t.presenter.clearAllSavedStories(),t._showNotification("Semua story berhasil dihapus dari tersimpan"),t.showEmptyState("deleted"))}))}},{key:"displaySavedStories",value:function(t){var e=this,n=document.getElementById("saved-story-list");if(n)if(n.classList.remove("content-loading"),this._toggleControlsVisibility(t&&t.length>0),t&&0!==t.length){n.innerHTML=t.map((function(t,n){return'\n      <div class="story-item saved-story-item" style="animation-delay: '.concat(.1*n,'s">\n        <div class="saved-indicator">\n          <i class="fas fa-bookmark"></i>\n          <span class="saved-date">Disimpan pada: ').concat(e.formatDate(t.savedAt),'</span>\n        </div>\n        <div class="story-image-container">\n          <img src="').concat(t.photoUrl,'" \n               alt="Foto oleh ').concat(t.name,": ").concat(t.description,'"\n               loading="lazy"\n               onerror="this.onerror=null; this.src=\'/images/icons/icon-192x192.png\'; this.alt=\'Gambar tidak tersedia saat offline\';">\n        </div>\n        <div class="story-content">\n          <h2 class="story-title">').concat(t.name,'</h2>\n          <p class="story-description">').concat(t.description,'</p>\n          <p class="created-at"><i class="fas fa-calendar"></i> Dibuat pada: ').concat(e.formatDate(t.createdAt),"</p>\n          ").concat(t.lat&&t.lon?e._isOnline?'<div class="mini-map" \n                     data-lat="'.concat(t.lat,'" \n                     data-lon="').concat(t.lon,'"></div>'):'<div class="offline-map-placeholder">\n                     <i class="fas fa-map-marker-alt"></i> Lokasi: '.concat(t.lat.toFixed(4),", ").concat(t.lon.toFixed(4),"\n                     <p>Peta tidak tersedia saat offline</p>\n                   </div>"):"",'\n          <div class="story-action">\n            <a href="#/story/').concat(t.id,'" class="detail-button">\n              <i class="fas fa-eye"></i> Lihat Detail\n            </a>\n            <button class="unsave-button" data-id="').concat(t.id,'">\n              <i class="fas fa-trash"></i> Hapus dari Tersimpan\n            </button>\n          </div>\n        </div>\n      </div>\n    ')})).join("");var r=document.createElement("style");r.textContent="\n      .saved-stories-container {\n        max-width: 1200px;\n        margin: 0 auto;\n        padding: 20px;\n      }\n      \n      .page-header {\n        margin-bottom: 40px;\n        text-align: center;\n        position: relative;\n        padding-bottom: 20px;\n      }\n      \n      .page-header::after {\n        content: '';\n        position: absolute;\n        bottom: 0;\n        left: 50%;\n        transform: translateX(-50%);\n        width: 100px;\n        height: 4px;\n        background: linear-gradient(to right, var(--secondary-color), var(--primary-color));\n        border-radius: 2px;\n      }\n      \n      .page-header h1 {\n        color: var(--primary-color);\n        margin-bottom: 15px;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 12px;\n        font-size: 2.2rem;\n      }\n      \n      .page-header h1 i {\n        color: var(--secondary-color);\n      }\n      \n      .page-header .subtitle {\n        color: var(--text-color-medium);\n        font-size: 1.15rem;\n        max-width: 600px;\n        margin: 0 auto;\n      }\n      \n      .saved-stories-controls {\n        display: flex;\n        justify-content: space-between;\n        align-items: center;\n        margin-bottom: 30px;\n        flex-wrap: wrap;\n        gap: 15px;\n        background-color: var(--bg-light);\n        padding: 15px 20px;\n        border-radius: 10px;\n        box-shadow: var(--shadow-small);\n      }\n      \n      .sorting-options {\n        display: flex;\n        align-items: center;\n        gap: 12px;\n      }\n      \n      .sorting-options label {\n        font-weight: 600;\n        color: var(--text-color-dark);\n      }\n      \n      .sort-select {\n        padding: 10px 15px;\n        border-radius: 8px;\n        border: 1px solid var(--border-color);\n        background-color: white;\n        font-family: inherit;\n        font-size: 0.95rem;\n        box-shadow: var(--shadow-small);\n        transition: all 0.3s ease;\n        cursor: pointer;\n        min-width: 200px;\n      }\n      \n      .sort-select:hover, .sort-select:focus {\n        border-color: var(--primary-color);\n        box-shadow: 0 0 0 2px rgba(52, 152, 219, 0.2);\n        outline: none;\n      }\n      \n      .btn-danger {\n        background-color: #e74c3c;\n        color: white;\n        border: none;\n        padding: 10px 20px;\n        border-radius: 8px;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n        transition: all 0.3s ease;\n        font-weight: 600;\n        box-shadow: var(--shadow-small);\n      }\n      \n      .btn-danger:hover {\n        background-color: #c0392b;\n        transform: translateY(-2px);\n        box-shadow: 0 6px 12px rgba(0,0,0,0.15);\n      }\n      \n      /* App shell skeletons */\n      .content-loading {\n        display: grid;\n        gap: 30px;\n      }\n      \n      .app-shell-skeleton {\n        background: linear-gradient(90deg, #f0f0f0 25%, #e0e0e0 50%, #f0f0f0 75%);\n        background-size: 200% 100%;\n        animation: skeleton-loading 1.5s infinite;\n        border-radius: 10px;\n        height: 250px;\n      }\n      \n      @keyframes skeleton-loading {\n        0% { background-position: 200% 0; }\n        100% { background-position: -200% 0; }\n      }\n      \n      /* Story items */\n      #saved-story-list {\n        display: grid;\n        grid-template-columns: repeat(auto-fill, minmax(350px, 1fr));\n        gap: 30px;\n      }\n      \n      .saved-story-item {\n        background-color: white;\n        border-radius: 12px;\n        overflow: hidden;\n        box-shadow: var(--shadow-medium);\n        border: 1px solid var(--border-color);\n        position: relative;\n        transition: all 0.3s ease;\n        animation: fade-in 0.5s ease forwards;\n        opacity: 0;\n        transform: translateY(20px);\n        display: flex;\n        flex-direction: column;\n      }\n      \n      @keyframes fade-in {\n        to {\n          opacity: 1;\n          transform: translateY(0);\n        }\n      }\n      \n      .saved-story-item:hover {\n        transform: translateY(-5px);\n        box-shadow: var(--shadow-large);\n        border-color: var(--secondary-color);\n      }\n      \n      .story-image-container {\n        height: 200px;\n        overflow: hidden;\n      }\n      \n      .saved-story-item img {\n        width: 100%;\n        height: 100%;\n        object-fit: cover;\n        transition: transform 0.5s ease;\n      }\n      \n      .saved-story-item:hover img {\n        transform: scale(1.05);\n      }\n      \n      .story-content {\n        padding: 20px;\n        display: flex;\n        flex-direction: column;\n        flex-grow: 1;\n      }\n      \n      .story-title {\n        font-size: 1.4rem;\n        color: var(--primary-color);\n        margin-bottom: 10px;\n        line-height: 1.3;\n      }\n      \n      .story-description {\n        color: var(--text-color-medium);\n        margin-bottom: 15px;\n        line-height: 1.5;\n        flex-grow: 1;\n      }\n      \n      .created-at {\n        font-size: 0.9rem;\n        color: var(--text-color-light);\n        margin-bottom: 15px;\n        display: flex;\n        align-items: center;\n        gap: 8px;\n      }\n      \n      .saved-indicator {\n        position: absolute;\n        top: 15px;\n        right: 15px;\n        background-color: rgba(52, 152, 219, 0.9);\n        color: white;\n        padding: 8px 12px;\n        border-radius: 30px;\n        font-size: 0.85rem;\n        font-weight: 600;\n        display: flex;\n        align-items: center;\n        gap: 6px;\n        box-shadow: 0 2px 10px rgba(0,0,0,0.2);\n        z-index: 10;\n        transition: all 0.3s ease;\n      }\n      \n      .saved-indicator i {\n        color: #ffeb3b;\n        font-size: 1rem;\n      }\n      \n      .saved-date {\n        display: none;\n        white-space: nowrap;\n        font-weight: 400;\n      }\n      \n      .saved-indicator:hover {\n        padding-right: 20px;\n      }\n      \n      .saved-indicator:hover .saved-date {\n        display: inline;\n        animation: fade-in 0.3s ease;\n      }\n      \n      /* Mini map styles */\n      .mini-map {\n        width: 100%;\n        height: 150px;\n        border-radius: 8px;\n        margin-bottom: 15px;\n        box-shadow: var(--shadow-small);\n        border: 1px solid var(--border-color);\n      }\n      \n      .offline-map-placeholder {\n        background-color: #f8f9fa;\n        padding: 15px;\n        border-radius: 8px;\n        text-align: center;\n        border: 1px dashed #ccc;\n        margin-bottom: 15px;\n        color: var(--text-color-medium);\n      }\n      \n      .offline-map-placeholder i {\n        color: var(--primary-color);\n        margin-right: 6px;\n      }\n      \n      .offline-map-placeholder p {\n        font-size: 0.9rem;\n        margin-top: 8px;\n        color: var(--text-color-light);\n      }\n      \n      /* Story actions */\n      .story-action {\n        display: flex;\n        justify-content: space-between;\n        gap: 10px;\n        margin-top: 10px;\n      }\n      \n      .detail-button {\n        flex: 1;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 8px;\n        background-color: var(--primary-color);\n        color: white;\n        padding: 10px 15px;\n        border-radius: 8px;\n        text-decoration: none;\n        font-weight: 600;\n        transition: all 0.3s ease;\n        box-shadow: var(--shadow-small);\n      }\n      \n      .detail-button:hover {\n        background-color: var(--primary-dark);\n        transform: translateY(-2px);\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n      }\n      \n      .unsave-button {\n        flex: 1;\n        background-color: #e74c3c;\n        color: white;\n        border: none;\n        padding: 10px 15px;\n        border-radius: 8px;\n        cursor: pointer;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        gap: 8px;\n        transition: all 0.3s ease;\n        font-weight: 600;\n        box-shadow: var(--shadow-small);\n      }\n      \n      .unsave-button:hover {\n        background-color: #c0392b;\n        transform: translateY(-2px);\n        box-shadow: 0 4px 12px rgba(0,0,0,0.15);\n      }\n      \n      /* Notification styles */\n      .toast-notification {\n        position: fixed;\n        bottom: 30px;\n        left: 50%;\n        transform: translateX(-50%);\n        background-color: #2ecc71;\n        color: white;\n        padding: 15px 25px;\n        border-radius: 10px;\n        box-shadow: 0 6px 16px rgba(0,0,0,0.2);\n        z-index: 1000;\n        opacity: 1;\n        transition: opacity 0.3s ease, transform 0.3s ease;\n        font-weight: 600;\n      }\n\n      .toast-notification.hidden {\n        opacity: 0;\n        transform: translate(-50%, 30px);\n      }\n      \n      /* Empty state styles */\n      .empty-state {\n        text-align: center;\n        padding: 60px 30px;\n        background-color: white;\n        border-radius: 16px;\n        box-shadow: var(--shadow-medium);\n        margin: 30px auto;\n        max-width: 600px;\n        animation: fade-in 0.5s ease;\n      }\n      \n      .empty-icon-container {\n        width: 120px;\n        height: 120px;\n        margin: 0 auto 30px;\n        background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        box-shadow: 0 10px 20px rgba(0, 188, 212, 0.2);\n      }\n      \n      .empty-icon-container i {\n        font-size: 4rem;\n        color: #00acc1;\n      }\n      \n      .empty-state h3 {\n        font-size: 1.8rem;\n        color: var(--primary-color);\n        margin-bottom: 15px;\n        font-weight: 700;\n      }\n      \n      .empty-state p {\n        color: var(--text-color-medium);\n        margin-bottom: 30px;\n        font-size: 1.1rem;\n        line-height: 1.6;\n        max-width: 450px;\n        margin-left: auto;\n        margin-right: auto;\n      }\n      \n      .empty-state-actions {\n        display: flex;\n        justify-content: center;\n      }\n      \n      .empty-state .btn-primary {\n        display: inline-flex;\n        align-items: center;\n        gap: 10px;\n        background-color: var(--primary-color);\n        color: white;\n        padding: 14px 28px;\n        border-radius: 50px;\n        text-decoration: none;\n        font-weight: 600;\n        transition: all 0.3s ease;\n        box-shadow: var(--shadow-medium);\n      }\n      \n      .empty-state .btn-primary:hover {\n        background-color: var(--primary-dark);\n        transform: translateY(-3px);\n        box-shadow: 0 8px 15px rgba(0,0,0,0.15);\n      }\n      \n      /* Error state */\n      .error {\n        background-color: #ffebee;\n        border-left: 4px solid #e74c3c;\n        padding: 15px 20px;\n        border-radius: 8px;\n        color: #c0392b;\n        font-weight: 600;\n        margin: 20px 0;\n        box-shadow: var(--shadow-small);\n      }\n      \n      /* Responsive styles */\n      @media (max-width: 992px) {\n        #saved-story-list {\n          grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));\n        }\n      }\n      \n      @media (max-width: 768px) {\n        .page-header h1 {\n          font-size: 1.8rem;\n        }\n        \n        .page-header .subtitle {\n          font-size: 1rem;\n        }\n        \n        .saved-stories-controls {\n          padding: 12px 15px;\n        }\n        \n        #saved-story-list {\n          grid-template-columns: 1fr;\n        }\n      }\n      \n      @media (max-width: 600px) {\n        .saved-stories-controls {\n          flex-direction: column;\n          align-items: stretch;\n        }\n        \n        .sorting-options {\n          width: 100%;\n          flex-direction: column;\n          align-items: flex-start;\n        }\n        \n        .sort-select {\n          width: 100%;\n        }\n        \n        .btn-danger {\n          width: 100%;\n          justify-content: center;\n        }\n        \n        .story-action {\n          flex-direction: column;\n        }\n      }\n    ",document.head.appendChild(r),document.querySelectorAll(".unsave-button").forEach((function(t){t.addEventListener("click",(function(t){var n=t.currentTarget.dataset.id;n&&e.presenter.deleteSavedStory(n)}))})),this._isOnline&&this.initMiniMaps()}else this.showEmptyState("empty")}},{key:"_toggleControlsVisibility",value:function(t){var e=document.getElementById("saved-stories-controls");e&&(t?(e.style.display="flex",e.style.animation="fade-in 0.5s ease forwards"):(e.style.animation="fade-out 0.3s ease forwards",setTimeout((function(){e.style.display="none"}),300)))}},{key:"showEmptyState",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"empty",e=document.getElementById("saved-story-list");if(e){e.classList.remove("content-loading"),this._toggleControlsVisibility(!1);var n="deleted"===t?"Semua Story Telah Dihapus":"Belum Ada Story Tersimpan",r="deleted"===t?"Anda telah menghapus semua story tersimpan. Jelajahi story di beranda dan simpan yang baru untuk dibaca nanti!":"Anda belum menyimpan story favorit. Jelajahi story di beranda dan simpan untuk dibaca nanti!",o="deleted"===t?"fa-trash-restore":"fa-bookmark",i="deleted"===t?"bounce-in":"fade-in";e.innerHTML='\n      <div class="empty-state '.concat(i,'">\n        <div class="empty-icon-container">\n          <i class="fas ').concat(o,'"></i>\n        </div>\n        <h3>').concat(n,"</h3>\n        <p>").concat(r,'</p>\n        <div class="empty-state-actions">\n          <a href="#/" class="btn-primary">\n            <i class="fas fa-home"></i> Kembali ke Beranda\n          </a>\n        </div>\n      </div>\n    ');var a=document.createElement("style");a.textContent="\n      .empty-state {\n        text-align: center;\n        padding: 60px 30px;\n        background-color: white;\n        border-radius: 16px;\n        box-shadow: var(--shadow-medium);\n        margin: 30px auto;\n        max-width: 600px;\n      }\n      \n      .empty-state.fade-in {\n        animation: fade-in 0.8s ease forwards;\n      }\n      \n      .empty-state.bounce-in {\n        animation: bounce-in 0.8s cubic-bezier(0.19, 1.0, 0.22, 1.0) forwards;\n      }\n      \n      @keyframes bounce-in {\n        0% {\n          opacity: 0;\n          transform: scale(0.8) translateY(30px);\n        }\n        60% {\n          opacity: 1;\n          transform: scale(1.05) translateY(-10px);\n        }\n        100% {\n          opacity: 1;\n          transform: scale(1) translateY(0);\n        }\n      }\n      \n      @keyframes fade-out {\n        from {\n          opacity: 1;\n          transform: translateY(0);\n        }\n        to {\n          opacity: 0;\n          transform: translateY(-20px);\n        }\n      }\n      \n      .empty-icon-container {\n        width: 120px;\n        height: 120px;\n        margin: 0 auto 30px;\n        background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        box-shadow: 0 10px 20px rgba(0, 188, 212, 0.2);\n        animation: pulse 2s infinite;\n      }\n      \n      @keyframes pulse {\n        0% {\n          box-shadow: 0 10px 20px rgba(0, 188, 212, 0.2);\n        }\n        50% {\n          box-shadow: 0 10px 30px rgba(0, 188, 212, 0.4);\n        }\n        100% {\n          box-shadow: 0 10px 20px rgba(0, 188, 212, 0.2);\n        }\n      }\n      \n      .empty-icon-container i {\n        font-size: 4rem;\n        color: #00acc1;\n      }\n      \n      .empty-state h3 {\n        font-size: 1.8rem;\n        color: var(--primary-color);\n        margin-bottom: 15px;\n        font-weight: 700;\n      }\n      \n      .empty-state p {\n        color: var(--text-color-medium);\n        margin-bottom: 30px;\n        font-size: 1.1rem;\n        line-height: 1.6;\n        max-width: 450px;\n        margin-left: auto;\n        margin-right: auto;\n      }\n      \n      .empty-state-actions {\n        display: flex;\n        justify-content: center;\n      }\n      \n      .empty-state .btn-primary {\n        display: inline-flex;\n        align-items: center;\n        gap: 10px;\n        background-color: var(--primary-color);\n        color: white;\n        padding: 14px 28px;\n        border-radius: 50px;\n        text-decoration: none;\n        font-weight: 600;\n        transition: all 0.3s ease;\n        box-shadow: var(--shadow-medium);\n      }\n      \n      .empty-state .btn-primary:hover {\n        background-color: var(--primary-dark);\n        transform: translateY(-3px);\n        box-shadow: 0 8px 15px rgba(0,0,0,0.15);\n      }\n    ",document.head.appendChild(a)}}},{key:"formatDate",value:function(t){return new Date(t).toLocaleDateString("id-ID",{day:"numeric",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"})}},{key:"initMiniMaps",value:function(){document.querySelectorAll(".mini-map").forEach((function(t){var e=t.dataset.lat,n=t.dataset.lon;if(e&&n)try{var r=L.map(t,{zoomControl:!1,attributionControl:!1}).setView([e,n],13);L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{maxZoom:19,minZoom:5}).addTo(r),L.marker([e,n],{title:"Location: ".concat(parseFloat(e).toFixed(4),", ").concat(parseFloat(n).toFixed(4)),alt:"Story Location",icon:L.icon({iconUrl:"/images/icons/map_marker_x32.png",iconSize:[32,32],iconAnchor:[16,32],popupAnchor:[0,-28]})}).addTo(r),setTimeout((function(){r.invalidateSize()}),500)}catch(e){console.error("Error initializing mini map:",e),t.innerHTML='<div class="map-error">Failed to load map</div>',t.style.height="50px",t.style.display="flex",t.style.alignItems="center",t.style.justifyContent="center",t.style.background="#ffdddd",t.style.color="#ff5555",t.style.fontWeight="bold"}}))}},{key:"_showNotification",value:function(t){var e=document.querySelector(".toast-notification");e||((e=document.createElement("div")).className="toast-notification hidden",document.body.appendChild(e)),e.textContent=t,e.classList.remove("hidden"),setTimeout((function(){e.classList.add("hidden")}),3e3)}},{key:"showError",value:function(t){var e=document.getElementById("saved-story-list");e&&(e.classList.remove("content-loading"),e.innerHTML='<p class="error">⛔ '.concat(t,"</p>"))}}],e&&Ge(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();function Be(t){return Be="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Be(t)}function Me(){Me=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Be(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(Be(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function ze(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function De(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){ze(i,r,o,a,c,"next",t)}function c(t){ze(i,r,o,a,c,"throw",t)}a(void 0)}))}}function qe(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Ye(r.key),r)}}function Ye(t){var e=function(t){if("object"!=Be(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=Be(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Be(e)?e:e+""}var He=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(r=De(Me().mark((function t(){return Me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container not-found-container" id="main-content">\n        <div class="not-found-content">\n          <div class="not-found-icon">\n            <i class="fas fa-map-signs"></i>\n          </div>\n          <h1>404</h1>\n          <h2>Halaman Tidak Ditemukan</h2>\n          <p>Maaf, halaman yang Anda cari tidak ditemukan. Mungkin URL yang Anda masukkan salah atau halaman tersebut sudah tidak tersedia.</p>\n          <div class="not-found-actions">\n            <a href="#/" class="btn-primary">\n              <i class="fas fa-home"></i> Kembali ke Beranda\n            </a>\n            <a href="#/saved-stories" class="btn-secondary">\n              <i class="fas fa-bookmark"></i> Story Tersimpan\n            </a>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})},{key:"afterRender",value:(n=De(Me().mark((function t(){var e;return Me().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:localStorage.getItem("token")?H.setupAuthenticatedNavigation():H.setupUnauthenticatedNavigation(),(e=document.createElement("style")).textContent="\n      .not-found-container {\n        display: flex;\n        justify-content: center;\n        align-items: center;\n        min-height: 80vh;\n        padding: 30px;\n      }\n      \n      .not-found-content {\n        text-align: center;\n        max-width: 600px;\n        background-color: white;\n        border-radius: 16px;\n        padding: 40px;\n        box-shadow: var(--shadow-medium);\n        animation: fade-in 0.6s ease-out forwards;\n      }\n      \n      @keyframes fade-in {\n        from {\n          opacity: 0;\n          transform: translateY(20px);\n        }\n        to {\n          opacity: 1;\n          transform: translateY(0);\n        }\n      }\n      \n      .not-found-icon {\n        width: 120px;\n        height: 120px;\n        margin: 0 auto 30px;\n        background: linear-gradient(135deg, #e0f7fa 0%, #b2ebf2 100%);\n        border-radius: 50%;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        box-shadow: 0 10px 20px rgba(0, 188, 212, 0.2);\n        animation: floating 3s ease-in-out infinite;\n      }\n      \n      @keyframes floating {\n        0% {\n          transform: translateY(0px);\n        }\n        50% {\n          transform: translateY(-10px);\n        }\n        100% {\n          transform: translateY(0px);\n        }\n      }\n      \n      .not-found-icon i {\n        font-size: 4rem;\n        color: #00acc1;\n      }\n      \n      .not-found-content h1 {\n        font-size: 6rem;\n        font-weight: 800;\n        color: var(--primary-color);\n        margin: 0;\n        line-height: 1;\n        letter-spacing: -2px;\n        opacity: 0.7;\n        margin-bottom: 10px;\n      }\n      \n      .not-found-content h2 {\n        font-size: 2rem;\n        color: var(--text-color-dark);\n        margin-bottom: 20px;\n        font-weight: 700;\n      }\n      \n      .not-found-content p {\n        font-size: 1.1rem;\n        color: var(--text-color-medium);\n        margin-bottom: 30px;\n        line-height: 1.6;\n      }\n      \n      .not-found-actions {\n        display: flex;\n        justify-content: center;\n        gap: 15px;\n        flex-wrap: wrap;\n      }\n      \n      .not-found-actions a {\n        display: inline-flex;\n        align-items: center;\n        gap: 8px;\n        padding: 12px 24px;\n        border-radius: 50px;\n        text-decoration: none;\n        font-weight: 600;\n        transition: all 0.3s ease;\n      }\n      \n      .btn-primary {\n        background-color: var(--primary-color);\n        color: white;\n        box-shadow: 0 4px 10px rgba(52, 152, 219, 0.3);\n      }\n      \n      .btn-primary:hover {\n        background-color: var(--primary-dark);\n        transform: translateY(-3px);\n        box-shadow: 0 6px 15px rgba(52, 152, 219, 0.4);\n      }\n      \n      .btn-secondary {\n        background-color: #f1f5f9;\n        color: var(--text-color-dark);\n        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);\n      }\n      \n      .btn-secondary:hover {\n        background-color: #e2e8f0;\n        transform: translateY(-3px);\n        box-shadow: 0 6px 15px rgba(0, 0, 0, 0.15);\n      }\n      \n      @media (max-width: 768px) {\n        .not-found-content {\n          padding: 30px 20px;\n        }\n        \n        .not-found-content h1 {\n          font-size: 5rem;\n        }\n        \n        .not-found-content h2 {\n          font-size: 1.5rem;\n        }\n        \n        .not-found-icon {\n          width: 100px;\n          height: 100px;\n          margin-bottom: 20px;\n        }\n        \n        .not-found-icon i {\n          font-size: 3rem;\n        }\n      }\n      \n      @media (max-width: 480px) {\n        .not-found-actions {\n          flex-direction: column;\n        }\n        \n        .not-found-content h1 {\n          font-size: 4rem;\n        }\n      }\n    ",document.head.appendChild(e);case 5:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}],e&&qe(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,r}();const Re={"/":new ct,"/login":new wt,"/register":new At,"/add-story":new Jt,"/story/:id":new le,"/about":new xe,"/saved-stories":new Fe};var Ue=new He;function We(t){return We="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},We(t)}function Je(){Je=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==We(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(We(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function Ze(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function Ke(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){Ze(i,r,o,a,c,"next",t)}function c(t){Ze(i,r,o,a,c,"throw",t)}a(void 0)}))}}function Ve(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,Xe(r.key),r)}}function Xe(t){var e=function(t){if("object"!=We(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var n=e.call(t,"string");if("object"!=We(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==We(e)?e:e+""}function $e(t,e,n){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,n)}function Qe(t,e){return t.get(en(t,e))}function tn(t,e,n){return t.set(en(t,e),n),n}function en(t,e,n){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:n;throw new TypeError("Private element is not present on this object")}var nn=new WeakMap,rn=new WeakMap,on=new WeakMap,an=new WeakMap;function cn(t){return cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},cn(t)}function sn(){sn=function(){return e};var t,e={},n=Object.prototype,r=n.hasOwnProperty,o=Object.defineProperty||function(t,e,n){t[e]=n.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,n){return Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,n){return t[e]=n}}function l(t,e,n,r){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new P(r||[]);return o(a,"_invoke",{value:_(t,n,c)}),a}function f(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var p="suspendedStart",h="suspendedYield",d="executing",y="completed",v={};function m(){}function g(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(N([])));k&&k!==n&&r.call(k,a)&&(w=k);var L=b.prototype=m.prototype=Object.create(w);function E(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function S(t,e){function n(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==cn(l)&&r.call(l,"__await")?e.resolve(l.__await).then((function(t){n("next",t,a,c)}),(function(t){n("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return n("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,r){function o(){return new e((function(e,o){n(t,r,e,o)}))}return i=i?i.then(o,o):o()}})}function _(e,n,r){var o=p;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(r.method=i,r.arg=a;;){var c=r.delegate;if(c){var s=O(c,r);if(s){if(s===v)continue;return s}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(o===p)throw o=y,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);o=d;var u=f(e,n,r);if("normal"===u.type){if(o=r.done?y:h,u.arg===v)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(o=y,r.method="throw",r.arg=u.arg)}}}function O(e,n){var r=n.method,o=e.iterator[r];if(o===t)return n.delegate=null,"throw"===r&&e.iterator.return&&(n.method="return",n.arg=t,O(e,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),v;var i=f(o,e.iterator,n.arg);if("throw"===i.type)return n.method="throw",n.arg=i.arg,n.delegate=null,v;var a=i.arg;return a?a.done?(n[e.resultName]=a.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,v):a:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,v)}function j(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function P(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(j,this),this.reset(!0)}function N(e){if(e||""===e){var n=e[a];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function n(){for(;++o<e.length;)if(r.call(e,o))return n.value=e[o],n.done=!1,n;return n.value=t,n.done=!0,n};return i.next=i}}throw new TypeError(cn(e)+" is not iterable")}return g.prototype=b,o(L,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:g,configurable:!0}),g.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===g||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},E(S.prototype),u(S.prototype,c,(function(){return this})),e.AsyncIterator=S,e.async=function(t,n,r,o,i){void 0===i&&(i=Promise);var a=new S(l(t,n,r,o),i);return e.isGeneratorFunction(n)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},E(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),n=[];for(var r in e)n.push(r);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},e.values=N,P.prototype={constructor:P,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function o(r,o){return c.type="throw",c.arg=e,n.next=r,o&&(n.method="next",n.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=r.call(a,"catchLoc"),u=r.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,v):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),v},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),T(n),v}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var o=r.arg;T(n)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,n,r){return this.delegate={iterator:N(e),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=t),v}},e}function un(t,e,n,r,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void n(t)}c.done?e(s):Promise.resolve(s).then(r,o)}function ln(t){return function(){var e=this,n=arguments;return new Promise((function(r,o){var i=t.apply(e,n);function a(t){un(i,r,o,a,c,"next",t)}function c(t){un(i,r,o,a,c,"throw",t)}a(void 0)}))}}var fn=new(function(){return t=function t(e){var n=e.navigationDrawer,r=e.drawerButton,o=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),$e(this,nn,null),$e(this,rn,null),$e(this,on,null),$e(this,an,null),tn(nn,this,o),tn(rn,this,r),tn(on,this,n),this._setupDrawer(),this._setupSkipLink(),this._setupFooter()},e=[{key:"_setupDrawer",value:function(){var t=this;Qe(rn,this).addEventListener("click",(function(){Qe(on,t).classList.toggle("open")})),document.body.addEventListener("click",(function(e){Qe(on,t).contains(e.target)||Qe(rn,t).contains(e.target)||Qe(on,t).classList.remove("open"),Qe(on,t).querySelectorAll("a").forEach((function(n){n.contains(e.target)&&Qe(on,t).classList.remove("open")}))}))}},{key:"_setupSkipLink",value:function(){document.addEventListener("click",(function(t){var e=document.querySelector(".skip-to-content");if(e&&t.target===e){t.preventDefault();var n=document.querySelector("#main-content");n.focus(),n.scrollIntoView({behavior:"smooth"}),n.classList.add("content-focused"),setTimeout((function(){n.classList.remove("content-focused")}),2e3)}}))}},{key:"_setupFooter",value:function(){if(!document.querySelector(".app-footer")){tn(an,this,document.createElement("footer")),Qe(an,this).className="app-footer",Qe(an,this).innerHTML='\n        <div class="footer-container">\n          <div class="footer-brand">\n            <span class="footer-logo">Myriadn</span>\n            <p class="footer-tagline">yep that\'s my name</p>\n          </div>\n        </div>\n      ',document.body.appendChild(Qe(an,this));var t=document.createElement("style");t.textContent='\n        .app-footer {\n          background: #1a2a3a;\n          color: #fff;\n          box-shadow: 0 -4px 15px rgba(0, 0, 0, 0.2);\n          border-top: 1px solid #2c3e50;\n          width: 100%;\n          padding: 20px 0;\n        }\n        \n        .footer-container {\n          max-width: 800px;\n          margin: 0 auto;\n          padding: 15px 24px;\n          display: flex;\n          justify-content: center;\n          align-items: center;\n          border-radius: var(--border-radius-lg);\n          background-color: rgba(255, 255, 255, 0.05);\n          box-shadow: 0 2px 10px rgba(0, 0, 0, 0.15);\n        }\n        \n        .footer-brand {\n          display: flex;\n          flex-direction: column;\n          align-items: center;\n          text-align: center;\n        }\n        \n        .footer-logo {\n          font-family: "Poppins", sans-serif;\n          font-size: 1.5rem;\n          font-weight: 200;\n          color: #fff;\n          letter-spacing: 2px;\n          text-shadow: 1px 1px 3px rgba(0, 0, 0, 0.3);\n          margin-bottom: 8px;\n        }\n        \n        .footer-tagline {\n          font-family: "Open Sans", sans-serif;\n          font-weight: 300;\n          font-size: 0.9rem;\n          color: #b2ebf2;\n          margin: 0;\n          font-style: italic;\n        }\n        \n        /* Create space at bottom of body for footer */\n        body {\n          min-height: 100vh;\n          display: flex;\n          flex-direction: column;\n          justify-content: space-between;\n        }\n        \n        #app {\n          flex: 1;\n        }\n      ',document.head.appendChild(t)}}},{key:"_updateActiveNavItem",value:function(){var t=Vt(),e=document.querySelectorAll(".nav-list li");e.forEach((function(t){t.classList.remove("active")})),e.forEach((function(e){var n=e.querySelector("a");if(n){var r=n.getAttribute("href");if("#"===r)return;var o=r.replace("#","");("/"===t&&"/"===o||"/"!==t&&"/"!==o&&t.includes(o))&&e.classList.add("active")}}))}},{key:"_stopMediaStreams",value:function(){document.querySelectorAll("video").forEach((function(t){t.srcObject&&(t.srcObject.getTracks().forEach((function(t){return t.stop()})),t.srcObject=null)}))}},{key:"renderPage",value:(n=Ke(Je().mark((function t(){var e,n,r,o=this;return Je().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this._stopMediaStreams(),e=Vt(),n=Re[e]||Ue,t.prev=3,t.next=6,n.render();case 6:if(r=t.sent,!document.startViewTransition){t.next=11;break}document.startViewTransition(Ke(Je().mark((function t(){return Je().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Qe(nn,o).animate({opacity:[1,0]},{easing:"ease-out"}).finished;case 2:return Qe(nn,o).innerHTML=r,t.next=5,n.afterRender();case 5:o._updateActiveNavItem(),Qe(nn,o).animate({opacity:[0,1]},{easing:"ease-in"}),re();case 8:case"end":return t.stop()}}),t)})))),t.next=18;break;case 11:return Qe(nn,this).style.opacity=0,Qe(nn,this).innerHTML=r,t.next=15,n.afterRender();case 15:this._updateActiveNavItem(),Qe(nn,this).animate({opacity:[0,1]},{easing:"ease-in"}),re();case 18:t.next=25;break;case 20:t.prev=20,t.t0=t.catch(3),console.error("Error rendering page:",t.t0),Qe(nn,this).innerHTML='\n        <section class="container error-page" id="main-content">\n          <h1>Terjadi Kesalahan</h1>\n          <p class="error">Maaf, terjadi kesalahan saat memuat halaman. Silakan coba lagi.</p>\n          <a href="#/" class="btn-primary">Kembali ke Beranda</a>\n        </section>\n      ',re();case 25:case"end":return t.stop()}}),t,this,[[3,20]])}))),function(){return n.apply(this,arguments)})}],e&&Ve(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n}())({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer")});document.addEventListener("DOMContentLoaded",ln(sn().mark((function t(){return sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return localStorage.getItem("token")||window.location.hash.includes("/login")||window.location.hash.includes("/register")||(window.location.hash="/login"),t.next=4,S.registerServiceWorker();case 4:return t.sent&&console.log("Service Worker berhasil diregistrasi"),t.next=8,fn.renderPage();case 8:window.addEventListener("hashchange",ln(sn().mark((function t(){return sn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,fn.renderPage();case 2:case"end":return t.stop()}}),t)}))));case 9:case"end":return t.stop()}}),t)}))))})();